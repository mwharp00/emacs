;; -*- mode: emacs-lisp; coding: emacs-mule; -*-
;; --------------------------------------------------------------------------
;; Desktop File for Emacs
;; --------------------------------------------------------------------------
;; Created Thu Jul 10 11:06:06 2014
;; Desktop file format version 206
;; Emacs version 24.3.1

;; Global section:
(setq desktop-missing-file-warning nil)
(setq tags-file-name nil)
(setq tags-table-list nil)
(setq search-ring '("kill" "kb" "dired" "'cl" "ucid" "kbd" "requir" "auto-i" "cyg" "set-b" "/" "(t " "backg" "green" "wom" "pink"))
(setq regexp-search-ring '("SKD [0-9][0-9]" "S" "SKD [0-9][0-9]" "music" "SKD [0-9][0-9]"))
(setq register-alist (list (list 119 "Unprintable entity" (let ((mk (make-marker))) (add-hook 'desktop-delay-hook (list 'lambda '() (list 'set-marker mk nil (get-buffer " *temp*")))) mk)) (list 82 "Unprintable entity" (let ((mk (make-marker))) (add-hook 'desktop-delay-hook (list 'lambda '() (list 'set-marker mk nil (get-buffer " *temp*")))) mk)) '(49 . " 348") '(48 . "\n* Configuration\n** About this file\n<<babel-init>>\n\nInspired by the [[http://eschulte.me/emacs24-starter-kit/#installation][Emacs Starter Kit]], I set up my configuration file\nusing Org-babel. Because my username is Sacha, I can save this as\nSacha.org in my =~/.emacs.d= directory to have it automatically load.\nYou could load it with =(org-babel-load-file \"/path/to/file\")=,\nchanging the path appropriately, but you'll probably want to tweak it\nextensively first. \n\nThis page: [[http://sachac.github.io/.emacs.d/Sacha.html][HTML]] - [[https://github.com/sachac/.emacs.d/blob/gh-pages/Sacha.org][Org]] - [[https://dl.dropbox.com/u/3968124/sacha-emacs.el][.el]] - [[http://sachac.github.io/.emacs.d/][Github]] - also, http://sach.ac/dotemacs\n\nTo be precise, this is what's in my init.el:\n\n#+begin_src emacs-lisp  :tangle no\n;; This sets up the load path so that we can override it\n(package-initialize nil)\n;; Override the packages with the git version of Org and other packages\n(add-to-list 'load-path \"~/elisp/org-mode/lisp\")\n(add-to-list 'load-path \"~/elisp/org-mode/contrib/lisp\")\n;;(add-to-list 'load-path \"~/Dropbox/2014/presentations/org-reveal\")\n;; Load the rest of the packages\n(package-initialize t)\n(require 'org)\n(require 'ob-tangle)\n(org-babel-load-file (expand-file-name \"~/.emacs.d/mharp.org\"))\n#+end_src\n\nIf you're new to Emacs Lisp, you probably don't want to copy and paste\nlarge chunks of this code. Instead, copy small parts of it (always\nmaking sure to copy a complete set of parentheses) into your\n=*scratch*= buffer or some other buffer in =emacs-lisp-mode=. Use =M-x\neval-buffer= to evaluate the code and see if you like the way that\nEmacs behaves. See [[https://www.gnu.org/software/emacs/manual/html_mono/eintr.html][An Introduction to Programming in Emacs Lisp]] for more details on Emacs Lisp. You can also find the manual by using =C-h i= (=info=) and choosing \"Emacs Lisp Intro\".\n\nI've installed a lot of packages. See the [[*Add%20package%20sources][package sources]] section to\nadd the repositories to your configuration. When you see =use-package=\nand a package name you might like, you can use =M-x package-install=\nto install the package of that name. Note that use-package is itself\nprovided by a package, so you'll probably want to install that and\n=bind-key=.\n\nIf you're viewing the Org file, you can open source code blocks (those are the ones in begin_src) in a separate buffer by moving your point inside them and typing C-c ' (=org-edit-special=). This opens another buffer in =emacs-lisp-mode=, so you can use =M-x eval-buffer= to load the changes. If you want to explore how functions work, use =M-x edebug-defun= to set up debugging for that function, and then call it. You can learn more about edebug in the [[http://www.gnu.org/software/emacs/manual/html_node/elisp/Edebug.html][Emacs Lisp]] manual.\n\nI like using =(setq ...)= more than Customize because I can neatly organize my configuration that way. \n\n** Personal information\n\n#+begin_src emacs-lisp\n  (setq user-full-name \"Mark W Harpster\"\n        user-mail-address \"mwharp@gmail.com\")\n#+end_src\n\n** Emacs initialization\n*** Add my elisp directory and other files\n\nSometimes I load files outside the package system. As long as they're\nin a directory in my =load-path=, Emacs can find them.\n\n#+begin_src emacs-lisp\n(add-to-list 'load-path \"~/.emacs.d\")\n(add-to-list 'load-path \"~/elisp\")\n;;(add-to-list 'load-path \"~/elisp/artbollocks-mode\")\n(require 'use-package)\n#+end_src\n\n*** Load secrets\n\nI keep slightly more sensitive information in a separate file so that I can easily publish my main configuration.\n\n#+begin_src emacs-lisp\n;;(load-file \"~/.emacs.secrets\")\n#+end_src\n\n*** Add package sources\n\n#+begin_src emacs-lisp\n(add-to-list 'package-archives '(\"org\" . \"http://orgmode.org/elpa/\") t)\n(add-to-list 'package-archives '(\"melpa\" . \"http://melpa.milkbox.net/packages/\") t)\n#+end_src\n\nUse =M-x package-refresh-contents= to reload the list of packages\nafter adding these for the first time.\n\n*** Byte-compile my init files to speed things up next time\n\nI hardly ever use this because I don't care about my Emacs startup\nspeed. The trick to using Emacs is to not close it. I start Emacs when\nmy computer boots up. I suspend my computer when I go to sleep. Pretty\nmuch the only time I shut down is when I need to update the system.\n\n#+begin_src emacs-lisp\n(defun sacha/byte-recompile ()\n  (interactive)\n  (byte-recompile-directory \"~/.emacs.d\" 0)\n  (byte-recompile-directory \"~/elisp\" 0))\n#+end_src\n\n*** Install packages if necessary\n\nELPA makes it easy to install packages without tracking down all the\ndifferent websites. Let's define a function that makes it easy to\ninstall packages. I don't actually use this a lot any more, but it can\nbe handy.\n\n#+begin_src emacs-lisp\n(defun sacha/package-install (package &optional repository)\n  \"Install PACKAGE if it has not yet been installed.\nIf REPOSITORY is specified, use that.\"\n  (unless (package-installed-p package)\n    (let ((package-archives (if repository\n                                (list (assoc repository package-archives))\n                              package-archives)))\n    (package-install package))))\n#+end_src\n\n** General configuration\n*** Backups\n\nThis is one of the things people usually want to change right away. By default, Emacs saves backup files in the current directory. These are the files ending in =~= that are cluttering up your directory lists. The following code stashes them all in =~/.emacs.d/backups=, where I can find them with =C-x C-f= (=find-file=) if I really need to.\n\n#+begin_src emacs-lisp\n(setq backup-directory-alist '((\".\" . \"~/.emacs.d/backups\")))\n#+end_src\n\nDisk space is cheap. Save lots.\n\n#+begin_src emacs-lisp\n(setq delete-old-versions -1)\n(setq version-control t)\n(setq vc-make-backup-files t)\n(setq auto-save-file-name-transforms '((\".*\" \"~/.emacs.d/auto-save-list\" t)))\n#+end_src\n\n*** History\n\nFrom http://www.wisdomandwonder.com/wordpress/wp-content/uploads/2014/03/C3F.html\n#+begin_src emacs-lisp\n(setq savehist-file \"~/.emacs.d/savehist\")\n(savehist-mode 1)\n(setq history-length t)\n(setq history-delete-duplicates t)\n(setq savehist-save-minibuffer-history 1)\n(setq savehist-additional-variables\n      '(kill-ring\n        search-ring\n        regexp-search-ring))\n#+end_src\n\n*** Windows configuration :drill:\n    SCHEDULED: <2013-03-03 Sun>\n    :PROPERTIES:\n    :ID:       440c0b9a-9068-450b-89a3-a20c8ec1f447\n    :DRILL_LAST_INTERVAL: 3.86\n    :DRILL_REPEATS_SINCE_FAIL: 2\n    :DRILL_TOTAL_REPEATS: 1\n    :DRILL_FAILURE_COUNT: 0\n    :DRILL_AVERAGE_QUALITY: 3.0\n    :DRILL_EASE: 2.36\n    :DRILL_LAST_QUALITY: 3\n    :DRILL_LAST_REVIEWED: [2013-02-27 Wed 23:14]\n    :END:\n\nWhen you're starting out, tooltips, menus, and the tool bar can be very helpful. [[http://sachachua.com/blog/2014/03/emacs-basics-using-mouse/][(Emacs Basics: Using the Mouse]]). Eventually, you may want to reclaim that extra little bit of screenspace. The following code turns those things off when using a graphical Emacs.\n\n#+begin_src emacs-lisp\n(when window-system\n  (tooltip-mode -1)\n  (tool-bar-mode -1)\n  (menu-bar-mode t)\n  (scroll-bar-mode t))\n#+end_src\n*** Winner mode - undo and redo window configuration\n\n=winner-mode= lets you use =C-c <left>= and =C-c <right>= to switch between window configurations. This is handy when something has popped up a buffer that you want to look at briefly before returning to whatever you were working on. When you're done, press =C-c <left>=.\n\n#+begin_src emacs-lisp\n;;  (use-package winner\n;;    :config (winner-mode 1))\n#+end_src\n*** Sentences end with a single space\n\nIn my world, sentences end with a single space. This makes\nsentence navigation commands work for me.\n\n#+begin_src emacs-lisp\n  (setq sentence-end-double-space nil)\n#+end_src\n\n*** Helm - interactive completion\n\nHelm makes it easy to complete various things. I find it to be easier\nto configure than ido in order to get completion in as many places as\npossible, although I prefer ido's way of switching buffers.\n\n#+begin_src emacs-lisp\n    (use-package helm\n      :init\n      (progn \n        (require 'helm-config) \n        (setq helm-candidate-number-limit 10)\n        ;; From https://gist.github.com/antifuchs/9238468\n        (setq helm-idle-delay 0.0 ; update fast sources immediately (doesn't).\n              helm-input-idle-delay 0.01  ; this actually updates things\n                                            ; reeeelatively quickly.\n              helm-quick-update t\n              helm-M-x-requires-pattern nil\n              helm-ff-skip-boring-files t)\n        (helm-mode))\n      :config\n      (progn\n        ;; I don't like the way switch-to-buffer uses history, since\n        ;; that confuses me when it comes to buffers I've already\n        ;; killed. Let's use ido instead.\n        (add-to-list 'helm-completing-read-handlers-alist '(switch-to-buffer . ido)))\n      :bind ((\"C-c h\" . helm-mini)))\n    (ido-mode -1) ;; Turn off ido mode in case I enabled it accidentally\n#+end_src\n*** Mode line format\n\nDisplay a more compact mode line\n\n#+begin_src emacs-lisp\n(use-package smart-mode-line\n  :init\n  (progn\n  (setq-default\n   mode-line-format \n   '(\"%e\"\n     mode-line-front-space\n     mode-line-mule-info\n     mode-line-client\n     mode-line-modified\n     mode-line-remote\n     mode-line-frame-identification\n     mode-line-buffer-identification\n     \"   \"\n     mode-line-position\n     (vc-mode vc-mode)\n     \"  \"\n     mode-line-modes\n     mode-line-misc-info\n     mode-line-end-spaces))))\n#+end_src\n\nHide minor modes I care less about:\n\n#+begin_src emacs-lisp\n(require 'diminish)\n(eval-after-load \"yasnippet\" '(diminish 'yas-minor-mode))\n(eval-after-load \"undo-tree\" '(diminish 'undo-tree-mode))\n(eval-after-load \"guide-key\" '(diminish 'guide-key-mode))\n(eval-after-load \"smartparens\" '(diminish 'smartparens-mode))\n(eval-after-load \"guide-key\" '(diminish 'guide-key-mode))\n(eval-after-load \"eldoc\" '(diminish 'eldoc-mode))\n(diminish 'visual-line-mode)\n#+end_src\n\n*** Change \"yes or no\" to \"y or n\"\n\nLazy people like me never want to type \"yes\" when \"y\" will suffice.\n\n#+begin_src emacs-lisp\n(fset 'yes-or-no-p 'y-or-n-p)   \n#+end_src\n\n*** Minibuffer editing - more space!\n\n    Sometimes you want to be able to do fancy things with the text\n    that you're entering into the minibuffer. Sometimes you just want\n    to be able to read it, especially when it comes to lots of text.\n    This binds =C-M-e= in a minibuffer) so that you can edit the\n    contents of the minibuffer before submitting it.\n\n#+begin_src emacs-lisp\n;;  (use-package miniedit\n;;    :commands minibuffer-edit\n;;    :init (miniedit-install))\n#+end_src\n\n*** Set up a light-on-dark color scheme\n\nI like light on dark because I find it to be more restful. The\ncolor-theme in ELPA was a little odd, though, so we define some advice to make\nit work. Some things still aren't quite right.\n\n#+begin_src emacs-lisp\n  (defadvice color-theme-alist (around sacha activate)\n    (if (ad-get-arg 0)\n        ad-do-it\n      nil))\n  (sacha/package-install 'color-theme)\n  (defun sacha/setup-color-theme ()\n    (interactive)\n    (color-theme-solarized 'dark)\n    (set-face-foreground 'secondary-selection \"darkblue\")\n    (set-face-background 'secondary-selection \"lightblue\")\n    (set-face-background 'font-lock-doc-face \"black\")\n    (set-face-foreground 'font-lock-doc-face \"wheat\")\n    (set-face-background 'font-lock-string-face \"black\")\n    (set-face-foreground 'org-todo \"green\")\n    (set-face-background 'org-todo \"black\"))\n\n  (use-package color-theme\n    :init\n    (sacha/setup-color-theme))\n#+end_src\n\nI sometimes need to switch to a lighter background for screenshots.\nFor that, I use =color-theme-vim=.\n\nSome more tweaks to solarized:\n#+begin_src emacs-lisp\n  (custom-set-faces\n   '(erc-input-face ((t (:foreground \"antique white\"))))\n   '(helm-selection ((t (:background \"ForestGreen\" :foreground \"black\"))))\n   '(org-agenda-clocking ((t (:inherit secondary-selection :foreground \"black\"))) t)\n   '(org-agenda-done ((t (:foreground \"dim gray\" :strike-through nil))))\n   '(org-done ((t (:foreground \"PaleGreen\" :weight normal :strike-through t))))\n   '(org-clock-overlay ((t (:background \"SkyBlue4\" :foreground \"black\"))))\n   '(org-headline-done ((((class color) (min-colors 16) (background dark)) (:foreground \"LightSalmon\" :strike-through t))))\n   '(outline-1 ((t (:inherit font-lock-function-name-face :foreground \"cornflower blue\")))))\n#+end_src\n\n*** Undo tree mode - visualize your undos and branches\n\nPeople often struggle with the Emacs undo model, where there's really no concept of \"redo\" - you simply undo the undo. \n# \nThis lets you use =C-x u= (=undo-tree-visualize=) to visually walk through the changes you've made, undo back to a certain point (or redo), and go down different branches.\n\n#+begin_src emacs-lisp\n  (use-package undo-tree\n    :init\n    (progn\n      (global-undo-tree-mode)\n      (setq undo-tree-visualizer-timestamps t)\n      (setq undo-tree-visualizer-diff t)))\n#+end_src\n\n*** Help - guide-key\n\nIt's hard to remember keyboard shortcuts. The =guide-key= package pops up help after a short delay.\n\n#+begin_src emacs-lisp\n(use-package guide-key\n  :init\n  (setq guide-key/guide-key-sequence '(\"C-x r\" \"C-x 4\" \"C-c\"))\n  (guide-key-mode 1))  ; Enable guide-key-mode\n#+end_src\n\n*** UTF-8\n\nFrom http://www.wisdomandwonder.com/wordpress/wp-content/uploads/2014/03/C3F.html\n#+begin_src emacs-lisp\n(prefer-coding-system 'utf-8)\n(when (display-graphic-p)\n  (setq x-select-request-type '(UTF8_STRING COMPOUND_TEXT TEXT STRING)))\n#+end_src\n*** Killing text\n\nFrom https://github.com/itsjeyd/emacs-config/blob/emacs24/init.el\n\n#+begin_src emacs-lisp\n  (defadvice kill-region (before slick-cut activate compile)\n    \"When called interactively with no active region, kill a single line instead.\"\n    (interactive\n      (if mark-active (list (region-beginning) (region-end))\n        (list (line-beginning-position)\n          (line-beginning-position 2)))))\n#+end_src\n** Navigation\n*** Pop to mark\n\nHandy way of getting back to previous places.\n\n#+begin_src emacs-lisp\n(bind-key \"C-x p\" 'pop-to-mark-command)\n(setq set-mark-command-repeat-pop t)\n#+end_src\n*** Text size\n\n#+begin_src emacs-lisp\n(bind-key \"C-+\" 'text-scale-increase)\n(bind-key \"C--\" 'text-scale-decrease)\n#+end_src\n\n*** Helm-swoop - quickly finding lines\n\nThis promises to be a fast way to find things. Let's bind it to =Ctrl-Shift-S= to see if I can get used to that...\n\n#+begin_src emacs-lisp\n(use-package helm-swoop\n :bind ((\"C-S-s\" . helm-swoop)))\n#+end_src\n\n*** Windmove - switching between windows\n\nWindmove lets you move between windows with something more natural than cycling through =C-x o= (=other-window=).\nWindmove doesn't behave well with Org, so we need to use different keybindings.\n\n#+begin_src emacs-lisp\n  (use-package windmove\n    :bind\n    ((\"<f2> <right>\" . windmove-right)\n     (\"<f2> <left>\" . windmove-left)\n     (\"<f2> <up>\" . windmove-up)\n     (\"<f2> <down>\" . windmove-down)))\n#+end_src\n\n*** Searching based on the current word\n\nThis lets me search up and down. I don't use this often, though.\n\n#+begin_src emacs-lisp\n  (defun sacha/search-word-backward ()\n    \"Find the previous occurrence of the current word.\"\n    (interactive)\n    (let ((cur (point)))\n      (skip-syntax-backward \"w_\")\n      (goto-char\n       (if (re-search-backward (concat \"\\\\_<\" (current-word) \"\\\\_>\") nil t)\n           (match-beginning 0)\n         cur))))\n  \n  (defun sacha/search-word-forward ()\n    \"Find the next occurrence of the current word.\"\n    (interactive)\n    (let ((cur (point)))\n      (skip-syntax-forward \"w_\")\n      (goto-char\n       (if (re-search-forward (concat \"\\\\_<\" (current-word) \"\\\\_>\") nil t)\n           (match-beginning 0)\n         cur))))\n  (defadvice search-for-keyword (around sacha activate)\n    \"Match in a case-insensitive way.\"\n    (let ((case-fold-search t))\n      ad-do-it))\n  (global-set-key '[M-up] 'sacha/search-word-backward)\n  (global-set-key '[M-down] 'sacha/search-word-forward)\n#+end_src\n\n*** Frequently-accessed files\nRegisters allow you to jump to a file or other location quickly. To\njump to a register, use =C-x r j= followed by the letter of the\nregister.\n\n#+begin_src emacs-lisp :results silent\n  (mapcar\n   (lambda (r)\n     (set-register (car r) (cons 'file (cdr r))))\n   '((?i . \"~/.emacs.d/Sacha.org\")\n     (?o . \"~/personal/organizer.org\")\n     (?b . \"~/personal/business.org\")\n     (?e . \"~/code/emacs-notes/tasks.org\")\n     (?w . \"~/Dropbox/public/sharing/index.org\")\n     (?W . \"~/Dropbox/public/sharing/blog.org\")\n     (?g . \"~/sachac.github.io/evil-plans/index.org\")\n     (?l . \"~/dropbox/public/sharing/learning.org\")))\n#+end_src\n\n*** Browse-kill-ring - see what you've cut so that you can paste it   :drill:\n    SCHEDULED: <2013-03-03 Sun>\n    :PROPERTIES:\n    :ID:       508ef5ff-f338-4cd6-8201-9bc76fa432e8\n    :DRILL_LAST_INTERVAL: 3.86\n    :DRILL_REPEATS_SINCE_FAIL: 2\n    :DRILL_TOTAL_REPEATS: 2\n    :DRILL_FAILURE_COUNT: 1\n    :DRILL_AVERAGE_QUALITY: 2.5\n    :DRILL_EASE: 2.36\n    :DRILL_LAST_QUALITY: 3\n    :DRILL_LAST_REVIEWED: [2013-02-27 Wed 21:18]\n    :END:\n\nMake sense of the kill ring! This lets you list the contents of the\nkill ring and paste a specific item. You can also manipulate your kill\nring contents.\n\nIf you're new to Emacs, you might not yet know about what the kill\nring is. It stores the items that you cut (or kill, in Emacs terms).\nYou're not limited to pasting just the most recent item - you can\npaste the second-to-the-last item you cut, and so on. I remember to\nuse =C-y= and =M-y= when going backwards in the kill ring, but I never\nquite remember how to go forward, so browse-kill-ring makes it easier.\n\n#+begin_src emacs-lisp\n  (sacha/package-install 'browse-kill-ring)\n  (use-package browse-kill-ring\n    :init \n    (progn \n      (browse-kill-ring-default-keybindings) ;; M-y\n      (setq browse-kill-ring-quit-action 'save-and-restore)))      \n#+end_src\n\n*** Key chords \nI'm on a Dvorak keyboard, so these might not work for you.\nExperimenting with this. =key-chord= lets you define keyboard\nshortcuts that use ordinary keys.\n\n#+begin_src emacs-lisp\n  (use-package key-chord\n    :init\n    (progn \n      (key-chord-mode 1)\n      (key-chord-define-global \"cg\"     'undo)\n      (key-chord-define-global \"yp\"     'other-window)))\n#+end_src\n*** Smartscan\n\nFrom https://github.com/itsjeyd/emacs-config/blob/emacs24/init.el\n\n#+begin_src emacs-lisp\n(use-package smartscan\n  :init (global-smartscan-mode t))\n#+end_src\n*** Dired\n\nFrom http://www.masteringemacs.org/articles/2011/03/25/working-multiple-files-dired/\n\n#+begin_src emacs-lisp\n(require 'find-dired)\n(setq find-ls-option '(\"-print0 | xargs -0 ls -ld\" . \"-ld\"))\n#+end_src\n** Reading\n\nhttps://github.com/xahlee/xah_emacs_init/blob/master/xah_emacs_font.el\nFrom Xah Lee:\n\n#+begin_src emacs-lisp\n(defun xah-toggle-margin-right ()\n  \"Toggle the right margin between `fill-column' or window width.\nThis command is convenient when reading novel, documentation.\"\n  (interactive)\n  (if (eq (cdr (window-margins)) nil)\n      (set-window-margins nil 0 (- (window-body-width) fill-column))\n    (set-window-margins nil 0 0)))\n#+end_src\n** Writing\n*** Avoiding weasel words\n    #+begin_src emacs-lisp\n      (use-package artbollocks-mode\n        :init\n        (progn\n          (setq artbollocks-weasel-words-regex\n                (concat \"\\\\b\" (regexp-opt\n                               '(\"one of the\"\n                                 \"should\"\n                                 \"just\"\n                                 \"sort of\"\n                                 \"a lot\"\n                                 \"probably\"\n                                 \"maybe\"\n                                 \"perhaps\"\n                                 \"I think\"\n                                 \"really\"\n                                 \"pretty\"\n                                 \"nice\"\n                                 \"action\"\n                                 \"utilize\"\n                                 \"leverage\") t) \"\\\\b\"))\n          ;; Don't show the art critic words, or at least until I figure\n          ;; out my own jargon\n          (setq artbollocks-jargon nil)))\n#+end_src\n\n*** Unfill paragraph\n\nI unfill paragraphs a lot because Wordpress likes adding extra =<br>= tags if I don't. (I should probably just tweak my Wordpress installation.)\n\n#+begin_src emacs-lisp\n  (defun sacha/unfill-paragraph (&optional region)\n    \"Takes a multi-line paragraph and makes it into a single line of text.\"\n    (interactive (progn\n                   (barf-if-buffer-read-only)\n                   (list t)))\n    (let ((fill-column (point-max)))\n      (fill-paragraph nil region)))\n(bind-key \"M-Q\" 'sacha/unfill-paragraph)\n#+end_src\n\nI never actually justify text, so I might as well change the way\n=fill-paragraph= works. With the code below, =M-q= will fill the\nparagraph normally, and =C-u M-q= will unfill it.\n\n#+begin_src emacs-lisp\n  (defun sacha/fill-or-unfill-paragraph (&optional unfill region)\n    \"Fill paragraph (or REGION).\n  With the prefix argument UNFILL, unfill it instead.\"\n    (interactive (progn\n                   (barf-if-buffer-read-only)\n                   (list (if current-prefix-arg 'unfill) t)))\n    (let ((fill-column (if unfill (point-max) fill-column)))\n      (fill-paragraph nil region)))\n(bind-key \"M-q\" 'sacha/fill-or-unfill-paragraph)\n#+end_src\n\nAlso, =visual-line-mode= is so much better than =auto-fill-mode=. It doesn't actually break the text into multiple lines - it only looks that way.\n\n#+begin_src emacs-lisp\n(remove-hook 'text-mode-hook #'turn-on-auto-fill)\n(add-hook 'text-mode-hook 'turn-on-visual-line-mode)\n#+end_src\n*** Transpose\n\n#+begin_src emacs-lisp\n;; Transpose stuff with M-t\n(bind-key \"M-t\" nil) ;; which used to be transpose-words\n(bind-key \"M-t l\" 'transpose-lines)\n(bind-key \"M-t w\" 'transpose-words)\n(bind-key \"M-t t\" 'transpose-words)\n(bind-key \"M-t M-t\" 'transpose-words)\n(bind-key \"M-t s\" 'transpose-sexps)\n#+end_src\n** Org\n\nI use [[http://www.orgmode.org][Org Mode]] to take notes, publish my blog, and do all sorts of\nstuff.\n\n*** My files\n\n#<<org-files>>\n\nHere are the Org files I use. I should probably organize them better. =)\n\n| organizer.org        | My main Org file. Inbox for M-x org-capture, tasks, weekly reviews, etc.                          |\n| business.org         | Business-related notes and TODOs                                                                  |\n| people.org           | People-related tasks                                                                              |\n| [[http://sachachua.com/evil-plans][evil-plans/index.org]] | High-level goals                                                                                  |\n| [[http://sachachua.com/outline][sharing/index.org]]    | Things to write about                                                                             |\n| decisions.org        | Pending, current, and reviewed decisions                                                          |\n| [[http://sachachua.com/blog/index][blog.org]]             | Topic index for my blog                                                                           |\n| [[http://sachachua.com/my-learning][learning.org]]         | Learning plan                                                                                     |\n| outline.org          | Huge outline of notes by category                                                                 |\n| tracking.org         | Temporary Org file for tracking various things                                                    |\n| delegation.org       | Templates for assigning tasks - now using Google Docs instead                                     |\n| books.org            | Huge file with book notes                                                                         |\n| calendar.org         | Used to use this with ical2org, but have been having problems with ical2org lately; no longer use |\n| ideal.org            | Planning ideal days                                                                               |\n| archive.org          | Archived subtrees                                                                                 |\n| latin.org            | Latin notes                                                                                       |\n| 101things.org        | Old goals for 101 things in 1001 days                                                             |\n| life.org             | Questions, processes, tools                                                                       |\n\n*** Modules\nOrg has a whole bunch of optional modules. These are the ones I'm\ncurrently experimenting with.\n#+begin_src emacs-lisp\n  (setq org-modules '(org-bbdb \n                      org-gnus\n                      org-drill\n                      org-info\n                      org-jsinfo\n                      org-habit\n                      org-irc\n                      org-mouse\n                      org-annotate-file\n                      org-eval\n                      org-expiry\n                      org-interactive-query\n                      org-man\n                      org-panel\n                      org-screen\n                      org-toc))\n(org-load-modules-maybe t)\n(setq org-expiry-inactive-timestamps t)\n#+end_src\n\n*** Keyboard shortcuts\n\n    #+begin_src emacs-lisp\n(defun reindent-whole-buffer ()\n  \"Reindent the whole buffer.\"\n  (interactive)\n  (indent-region (point-min)\n                 (point-max)))\n\n\n\n(defun insert-date-stamp()\n  (interactive)\n  (insert (org-read-date)))\n;;(set-background-color \"white\")\n(global-set-key (kbd \"<f5> b\") 'shell-command)\n(global-set-key (kbd \"<f5> s\") 'replace-string)\n(global-set-key (kbd \"<f5> c\") 'org-w3m-copy-for-org-mode)\n(global-set-key (kbd \"<f5> l\") 'getskd)\n(global-set-key (kbd \"<f9>\") 'escreen-prefix)\n(global-set-key (kbd \"s-c\") 'calendar)\n(global-set-key (kbd \"s-d\") 'insert-date-stamp)\n(global-set-key (kbd \"s-i\") 'imenu-anywhere)\n(global-set-key (kbd \"s-t\") 'orgtbl-mode)\n(global-set-key (kbd \"s-r\") 'revert-buffer)\n(global-set-key (kbd \"s-s\") 'mwh-create-set)\n(global-set-key (kbd \"s-q\") 'reindent-whole-buffer)\n(global-set-key (kbd \"<f7> t\") 'planner-create-task-from-buffer)\n(global-set-key (kbd \"<f7> r\") 'remember)\n(global-set-key (kbd \"<f7> c\") 'remember-region)\n(global-set-key (kbd \"<f7> n\") 'planner-create-note-from-task)\n\n      (bind-key \"C-c r\" 'org-capture)\n      (bind-key \"C-c a\" 'org-agenda)\n      (bind-key \"C-c l\" 'org-store-link)\n      (bind-key \"C-c L\" 'org-insert-link-global)\n      (bind-key \"C-c O\" 'org-open-at-point-global)\n      (bind-key \"<f9> <f9>\" 'org-agenda-list)\n      (bind-key \"<f9> <f8>\" (lambda () (interactive) (org-capture nil \"r\")))\n      (bind-key \"C-TAB\" 'org-cycle org-mode-map)\n      (bind-key \"C-c v\" 'org-show-todo-tree org-mode-map)\n      (bind-key \"C-c C-r\" 'org-refile org-mode-map)\n      (bind-key \"C-c R\" 'org-reveal org-mode-map)\n#+end_src\n\n=append-next-kill= is more useful to me than =org-table-copy-region=.\n\n#+begin_src emacs-lisp\n  (eval-after-load 'org\n    '(progn\n       (bind-key \"C-M-w\" 'append-next-kill org-mode-map)))\n#+end_src\n\nI don't use the diary, but I do use the clock a lot.\n\n#+begin_src emacs-lisp\n  (use-package org-agenda\n    :init (bind-key \"i\" 'org-agenda-clock-in org-agenda-mode-map))\n#+end_src\n    \n*** Navigation\n\nFrom http://stackoverflow.com/questions/15011703/is-there-an-emacs-org-mode-command-to-jump-to-an-org-heading\n#+begin_src emacs-lisp\n  (setq org-goto-interface 'outline\n        org-goto-max-level 10)\n  (require 'imenu)\n  (bind-key \"M-o\" 'imenu)\n  (bind-key \"C-c j\" 'org-clock-goto) ;; jump to current task from anywhere\n  (setq org-cycle-include-plain-lists 'integrate)\n#+end_src\n\n*** Link Org subtrees and navigate between them\nThe following code makes it easier for me to link trees with entries, as in http://sachachua.com/evil-plans\n\n#+begin_src emacs-lisp\n(defun sacha/org-follow-entry-link ()\n  \"Follow the defined link for this entry.\"\n  (interactive)\n  (if (org-entry-get (point) \"LINK\")\n      (org-open-link-from-string (org-entry-get (point) \"LINK\"))\n    (org-open-at-point)))\n\n(bind-key \"C-c o\" 'sacha/org-follow-entry-link org-mode-map)\n\n(defun sacha/org-link-projects (location)\n  \"Add link properties between the current subtree and the one specified by LOCATION.\"\n  (interactive\n   (list (let ((org-refile-use-cache nil))\n     (org-refile-get-location \"Location\"))))\n  (let ((link1 (org-store-link nil)) link2)\n    (save-window-excursion\n      (org-refile 4 nil location)\n      (setq link2 (org-store-link nil))\n      (org-set-property \"LINK\" link1))\n    (org-set-property \"LINK\" link2)))\n#+end_src\n\n*** Taking notes\n\n    My org files are in my =personal= directory, which is actually a\n    symlink to a directory in my Dropbox. That way, I can update my\n    Org files from multiple computers.\n    \n#+begin_src emacs-lisp\n  (setq org-directory \"~/personal\")\n  (setq org-default-notes-file \"~/personal/organizer.org\")\n#+end_src\n\nThis makes it easier to add links from outside.\n\n#+begin_src emacs-lisp\n(defun sacha/yank-more ()\n  (interactive)\n  (insert \"[[\")\n  (yank)\n  (insert \"][more]]\"))\n(global-set-key (kbd \"<f6>\") 'sacha/yank-more)\n#+end_src\n\n**** Templates\n\n     I use =org-capture= templates to quickly jot down tasks, ledger\n     entries, notes, and other semi-structured pieces of information.\n#+begin_src emacs-lisp     \n  (defvar sacha/org-basic-task-template \"* TODO %^{Task}    \n  SCHEDULED: %^t\n  %?\n  :PROPERTIES:\n  :Effort: %^{effort|1:00|0:05|0:15|0:30|2:00|4:00}\n  :END:\" \"Basic task data\")\n  (setq org-capture-templates\n        `((\"t\" \"Tasks\" entry \n           (file+headline \"~/personal/organizer.org\" \"Tasks\")\n           ,sacha/org-basic-task-template)\n          (\"b\" \"Business task\" entry\n           (file+headline \"~/personal/business.org\" \"Tasks\")\n           ,sacha/org-basic-task-template)\n          (\"p\" \"People task\" entry\n           (file+headline \"~/personal/people.org\" \"Tasks\")\n           ,sacha/org-basic-task-template)\n          (\"db\" \"Done - Business\" entry\n           (file+headline \"~/personal/business.org\" \"Tasks\")\n           \"* DONE %^{Task}\\nSCHEDULED: %^t\\n%?\")\n          (\"dp\" \"Done - People\" entry\n           (file+headline \"~/personal/people.org\" \"Tasks\")\n           \"* DONE %^{Task}\\nSCHEDULED: %^t\\n%?\")\n          (\"dt\" \"Done - Task\" entry\n           (file+headline \"~/personal/organizer.org\" \"Tasks\")\n           \"* DONE %^{Task}\\nSCHEDULED: %^t\\n%?\")\n          (\"q\" \"Quick note\" item\n           (file+headline \"~/personal/organizer.org\" \"Quick notes\"))\n          (\"l\" \"Ledger entries\")\n          (\"lm\" \"MBNA\" plain\n           (file \"~/personal/ledger\")\n           \"%(org-read-date) %^{Payee}\n    Liabilities:MBNA  \n    Expenses:%^{Account}  $%^{Amount}\n  \" :immediate-finish)\n          (\"ln\" \"No Frills\" plain\n           (file \"~/personal/ledger\")\n           \"%(let ((org-read-date-prefer-future nil)) (org-read-date)) * No Frills\n    Liabilities:MBNA  \n    Assets:Wayne:Groceries  $%^{Amount}\n  \" :immediate-finish)    \n          (\"lc\" \"Cash\" plain\n           (file \"~/personal/ledger\")\n           \"%(org-read-date) * %^{Payee}\n    Expenses:Cash \n    Expenses:%^{Account}  %^{Amount}\n  \")             \n          (\"b\" \"Book\" entry\n           (file+datetree \"~/personal/books.org\" \"Inbox\")\n           \"* %^{Title}  %^g\n  %i\n  ,*Author(s):* %^{Author} \\\\\\\\\n  ,*ISBN:* %^{ISBN}\n\n  %?\n\n  ,*Review on:* %^t \\\\\n  %a\n  %U\"\n           :clock-in :clock-resume)\n           (\"c\" \"Contact\" entry (file \"~/personal/contacts.org\")\n            \"* %(org-contacts-template-name)\n  :PROPERTIES:\n  :EMAIL: %(org-contacts-template-email)\n  :END:\")\n           (\"n\" \"Daily note\" table-line (file+olp \"~/personal/organizer.org\" \"Daily notes\")\n            \"| %u | %^{Note} |\"\n            :immediate-finish)\n           (\"r\" \"Notes\" entry\n            (file+datetree \"~/personal/organizer.org\")\n            \"* %?\\n\\n%i\\n\"\n            )))\n  (bind-key \"C-M-r\" 'org-capture)\n#+end_src\n***** Allow refiling in the middle(ish) of a capture\n\nThis lets me use =C-c C-r= to refile a capture and then jump to the\nnew location. I wanted to be able to file tasks under projects so that\nthey could inherit the QUANTIFIED property that I use to track time\n(and any Beeminder-related properties too), but I also wanted to be\nable to clock in on them.\n\n#+begin_src emacs-lisp\n  (defun sacha/org-capture-refile-and-jump ()\n    (interactive)\n    (org-capture-refile)\n    (org-refile-goto-last-stored))\n  (require 'org-capture)\n  (bind-key \"C-c C-r\" 'sacha/org-capture-refile-and-jump org-capture-mode-map)\n#+end_src\n\n**** Refiling\n\n=org-refile= lets you organize notes by typing in the headline to file them under.\n\n    #+begin_src emacs-lisp\n      (setq org-reverse-note-order t)\n      (setq org-refile-use-outline-path nil)\n      (setq org-refile-allow-creating-parent-nodes 'confirm)\n      (setq org-refile-use-cache nil)\n      (setq org-refile-targets '((org-agenda-files . (:maxlevel . 6))))\n      (setq org-blank-before-new-entry nil)\n    #+end_src\n    \n**** Estimating WPM\n\n     I'm curious about how fast I type some things.\n#+begin_src emacs-lisp\n(require 'org-clock)\n(defun sacha/org-entry-wpm ()\n  (interactive)\n  (save-restriction\n    (save-excursion\n      (org-narrow-to-subtree)\n      (goto-char (point-min))\n      (let* ((words (count-words-region (point-min) (point-max)))\n	     (minutes (org-clock-sum-current-item))\n	     (wpm (/ words minutes)))\n	(message \"WPM: %d (words: %d, minutes: %d)\" wpm words minutes)\n	(kill-new (number-to-string wpm))))))\n#+end_src\n\n*** Managing tasks\n**** Track TODO state\n<<todo-keywords>>\n\nThe parentheses indicate keyboard shortcuts that I can use to set the task state. @ and ! toggle logging.\n\n#+begin_src emacs-lisp\n       (setq org-todo-keywords\n        '((sequence\n           \"TODO(t)\"  ; next action\n           \"TOBLOG(b)\"  ; next action\n           \"STARTED(s)\"\n           \"WAITING(w@/!)\"\n           \"SOMEDAY(.)\" \"|\" \"DONE(x!)\" \"CANCELLED(c@)\")\n          (sequence \"TODELEGATE(-)\" \"DELEGATED(d)\" \"COMPLETE(x)\")))\n#+end_src\n\n#+begin_src emacs-lisp\n(setq org-todo-keyword-faces\n      '((\"TODO\" . (:foreground \"green\" :weight bold))\n        (\"DONE\" . (:foreground \"cyan\" :weight bold))\n        (\"WAITING\" . (:foreground \"red\" :weight bold))\n        (\"SOMEDAY\" . (:foreground \"gray\" :weight bold))))\n#+end_src     \n\n**** Projects\n\nProjects are headings with the =:project:= tag, so we generally don't\nwant that tag inherited, except when we display unscheduled tasks that\ndon't belong to any projects.\n\n     #+begin_src emacs-lisp\n       (setq org-tags-exclude-from-inheritance '(\"project\"))\n     #+end_src\n\nThis code makes it easy for me to focus on one project and its tasks.\n\n#+begin_src emacs-lisp\n  (add-to-list 'org-speed-commands-user '(\"N\" org-narrow-to-subtree))\n  (add-to-list 'org-speed-commands-user '(\"W\" widen))\n  (defun sacha/org-agenda-for-subtree ()\n    (interactive)\n    (if (derived-mode-p 'org-agenda-mode)\n      (let* ((marker (or (org-get-at-bol 'org-marker)\n                         (org-agenda-error)))\n             (hdmarker (or (org-get-at-bol 'org-hd-marker) marker))\n             (pos (marker-position marker))\n             (col (current-column))\n             newhead)\n        (org-with-remote-undo (marker-buffer marker)\n          (with-current-buffer (marker-buffer marker)\n            (widen)\n            (let ((org-agenda-view-columns-initially t))\n              (org-agenda nil \"t\" 'subtree)))))\n      (let ((org-agenda-view-columns-initially t))\n        (org-agenda nil \"t\" 'subtree))))\n  (add-to-list 'org-speed-commands-user '(\"T\" sacha/org-agenda-for-subtree))\n#+end_src\n\nThere's probably a proper way to do this, maybe with =<=. Oh, that would work nicely. =< C-c a t= too.\n\n**** Tag tasks with GTD-ish contexts\n\nThis defines keyboard shortcuts for those, too.\n\n     #+begin_src emacs-lisp\n              (setq org-tag-alist '((\"@work\" . ?b) \n                                    (\"@home\" . ?h) \n                                    (\"@writing\" . ?w)\n                                    (\"@errands\" . ?e) \n                                    (\"@drawing\" . ?d)\n                                    (\"@coding\" . ?c)\n                                    (\"@phone\" . ?p)\n                                    (\"@reading\" . ?r)\n                                    (\"@computer\" . ?l)\n                                    (\"quantified\" . ?q)\n                                    (\"lowenergy\" . ?0)\n                                    (\"highenergy\" . ?1)))\n     #+end_src\n**** Enable filtering by effort estimates\n\nThat way, it's easy to see short tasks that I can finish.\n\n#+begin_src emacs-lisp\n  (add-to-list 'org-global-properties\n        '(\"Effort_ALL\". \"0:05 0:15 0:30 1:00 2:00 3:00 4:00\"))\n#+end_src\n     \n**** Track time\n\n#+begin_src emacs-lisp\n  (setq org-clock-idle-time nil)\n  (setq org-log-done 'time)\n  (setq org-clock-persist t)\n  (org-clock-persistence-insinuate)\n  (setq org-clock-report-include-clocking-task t)\n  (defadvice org-clock-in (after sacha activate)\n    \"Mark STARTED when clocked in.\"\n    (save-excursion\n      (catch 'exit\n        (cond\n         ((derived-mode-p 'org-agenda-mode)\n          (let* ((marker (or (org-get-at-bol 'org-marker)\n                             (org-agenda-error)))\n                 (hdmarker (or (org-get-at-bol 'org-hd-marker) marker))\n                 (pos (marker-position marker))\n                 (col (current-column))\n                 newhead)\n            (org-with-remote-undo (marker-buffer marker)\n              (with-current-buffer (marker-buffer marker)\n                (widen)\n                (goto-char pos)\n                (org-back-to-heading t)\n                (if (org-get-todo-state)\n                    (org-todo \"STARTED\"))))))\n         (t (if (org-get-todo-state)\n                    (org-todo \"STARTED\")))))))\n#+end_src\n     \nToo many clock entries clutter up a heading.\n\n#+begin_src emacs-lisp\n(setq org-log-into-drawer \"LOGBOOK\")\n(setq org-clock-into-drawer 1)\n#+end_src\n\n**** Habits\n\n     I like using org-habits to track consistency. My task names tend\n     to be a bit long, though, so I've configured the graph column to\n     show a little bit more to the right.\n     \n#+begin_src emacs-lisp\n(setq org-habit-graph-column 80)\n(setq org-habit-show-habits-only-for-today nil)\n#+end_src\n\nIf you want to use habits, be sure to schedule your tasks and add a STYLE property with the value of =habit= to the tasks you want displayed.\n\n*** Estimating tasks\n\nFrom \"Add an effort estimate on the fly when clocking in\" on the\n[[http://orgmode.org/worg/org-hacks.html][Org Hacks]] page:\n\n#+begin_src emacs-lisp\n(add-hook 'org-clock-in-prepare-hook\n          'sacha/org-mode-ask-effort)\n\n(defun sacha/org-mode-ask-effort ()\n  \"Ask for an effort estimate when clocking in.\"\n  (unless (org-entry-get (point) \"Effort\")\n    (let ((effort\n           (completing-read\n            \"Effort: \"\n            (org-entry-get-multivalued-property (point) \"Effort\"))))\n      (unless (equal effort \"\")\n        (org-set-property \"Effort\" effort)))))\n#+end_src\n\n# <<subset>>\n*** Modifying org agenda so that I can display a subset of tasks\n\nI want to create an agenda command that displays a list of tasks by\ncontext. That way, I can quickly preview a bunch of contexts and\ndecide what I feel like doing the most.\n\n#+begin_src emacs-lisp\n  (defvar sacha/org-agenda-limit-items nil \"Number of items to show in agenda to-do views; nil if unlimited.\")\n  (defadvice org-agenda-finalize-entries (around sacha activate)\n    (if sacha/org-agenda-limit-items\n        (progn\n          (setq list (mapcar 'org-agenda-highlight-todo list))\n          (setq ad-return-value\n                (subseq list 0 sacha/org-agenda-limit-items))\n          (when org-agenda-before-sorting-filter-function\n            (setq list (delq nil (mapcar org-agenda-before-sorting-filter-function list))))\n          (setq ad-return-value\n                (mapconcat 'identity\n                           (delq nil \n                                 (subseq\n                                  (sort list 'org-entries-lessp)\n                                  0\n                                  sacha/org-agenda-limit-items))\n                           \"\\n\")))\n      ad-do-it))\n#+end_src\n\n*** Flexible scheduling of tasks\n\nI (theoretically) want to be able to schedule tasks for dates like the first Saturday\nof every month. Fortunately, [[http://stackoverflow.com/questions/13555385/org-mode-how-to-schedule-repeating-tasks-for-the-first-saturday-of-every-month][someone else has figured that out!]]\n\n#+begin_src emacs-lisp\n;; Get this from https://raw.github.com/chenfengyuan/elisp/master/next-spec-day.el\n(load-file \"~/elisp/next-spec-day.el\")\n#+end_src\n\n*** Org agenda\n**** Basic configuration\nI have quite a few Org files, but I keep my agenda items and TODOs in\nonly a few of them them for faster scanning.\n\n#+begin_src emacs-lisp\n  (setq org-agenda-files '(\n                           \"~/personal/organizer.org\"\n                           \"~/personal/people.org\"\n                           \"~/personal/business.org\"\n                           \"~/Dropbox/public/sharing/index.org\"\n                           \"~/dropbox/public/learning.org\"\n                           \"~/code/emacs-notes/tasks.org\"\n                           \"~/sachac.github.io/evil-plans/index.org\"\n                           \"~/personal/routines.org\"\n                           ))\n#+end_src\n\nI like looking at two days at a time when I plan using the Org\nagenda. I want to see my log entries, but I don't want to see\nscheduled items that I've finished. I like seeing a time grid so that\nI can get a sense of how appointments are spread out.\n\n#+begin_src emacs-lisp\n  (setq org-agenda-span 2)\n  (setq org-agenda-sticky nil)\n  (setq org-agenda-show-log t)\n  (setq org-agenda-skip-scheduled-if-done t)\n  (setq org-agenda-skip-deadline-if-done t)\n  (setq org-agenda-time-grid\n        '((daily today require-timed)\n         \"----------------\"\n         (800 1000 1200 1400 1600 1800)))\n  (setq org-columns-default-format \"%50ITEM %12SCHEDULED %TODO %3PRIORITY %Effort{:} %TAGS\")\n#+end_src\n\nSome other keyboard shortcuts:\n\n#+begin_src emacs-lisp\n(bind-key \"Y\" 'org-agenda-todo-yesterday org-agenda-mode-map)\n#+end_src\n\n# <<project_subtasks>>\n**** Starting my weeks on Saturday\n\nI like looking at weekends as [[http://sachachua.com/blog/2010/11/week-beginnings/][week beginnings]] instead, so I want the\nOrg agenda to start on Saturdays.\n\n#+begin_src emacs-lisp\n(setq org-agenda-start-on-weekday 6)\n#+end_src\n\n**** Display projects with associated subtasks\n\nI wanted a view that showed projects with a few subtasks underneath\nthem. Here's a sample of the output:\n\n#+begin_example\nHeadlines with TAGS match: +PROJECT\nPress `C-u r' to search again with new search string\n  organizer:  Set up communication processes for Awesome Foundation Toronto\n  organizer:  TODO Announce the next pitch night\n  organizer:  TODO Follow up with the winner of the previous pitch night for any news to include in the updates\n\n  organizer:  Tidy up the house so that I can find things quickly\n  organizer:  TODO Inventory all the things in closets and boxes         :@home:\n  organizer:  TODO Drop things off for donation                       :@errands:\n\n  organizer:  Learn how to develop for Android devices\n#+end_example\n\n#+begin_src emacs-lisp  \n  (defun sacha/org-agenda-project-agenda ()\n    \"Return the project headline and up to `sacha/org-agenda-limit-items' tasks.\"\n    (save-excursion\n      (let* ((marker (org-agenda-new-marker))\n             (heading\n              (org-agenda-format-item \"\" (org-get-heading) (org-get-category) nil))\n             (org-agenda-restrict t)\n             (org-agenda-restrict-begin (point))\n             (org-agenda-restrict-end (org-end-of-subtree 'invisible))\n             ;; Find the TODO items in this subtree\n             (list (org-agenda-get-day-entries (buffer-file-name) (calendar-current-date) :todo)))\n        (org-add-props heading\n            (list 'face 'defaults\n                  'done-face 'org-agenda-done\n                  'undone-face 'default\n                  'mouse-face 'highlight\n                  'org-not-done-regexp org-not-done-regexp\n                  'org-todo-regexp org-todo-regexp\n                  'org-complex-heading-regexp org-complex-heading-regexp\n                  'help-echo\n                  (format \"mouse-2 or RET jump to org file %s\"\n                          (abbreviate-file-name\n                           (or (buffer-file-name (buffer-base-buffer))\n                               (buffer-name (buffer-base-buffer))))))\n          'org-marker marker\n          'org-hd-marker marker\n          'org-category (org-get-category)\n          'type \"tagsmatch\")\n        (concat heading \"\\n\"\n                (org-agenda-finalize-entries list)))))\n          \n    (defun sacha/org-agenda-projects-and-tasks (match)\n      \"Show TODOs for all `org-agenda-files' headlines matching MATCH.\"\n      (interactive \"MString: \")\n      (let ((todo-only nil))\n        (if org-agenda-overriding-arguments\n            (setq todo-only (car org-agenda-overriding-arguments)\n                  match (nth 1 org-agenda-overriding-arguments)))\n        (let* ((org-tags-match-list-sublevels\n                org-tags-match-list-sublevels)\n               (completion-ignore-case t)\n               rtn rtnall files file pos matcher\n               buffer)\n          (when (and (stringp match) (not (string-match \"\\\\S-\" match)))\n            (setq match nil))\n          (setq matcher (org-make-tags-matcher match)\n                match (car matcher) matcher (cdr matcher))\n          (catch 'exit\n            (if org-agenda-sticky\n                (setq org-agenda-buffer-name\n                      (if (stringp match)\n                          (format \"*Org Agenda(%s:%s)*\"\n                                  (or org-keys (or (and todo-only \"M\") \"m\")) match)\n                        (format \"*Org Agenda(%s)*\" (or (and todo-only \"M\") \"m\")))))\n            (org-agenda-prepare (concat \"TAGS \" match))\n            (org-compile-prefix-format 'tags)\n            (org-set-sorting-strategy 'tags)\n            (setq org-agenda-query-string match)\n            (setq org-agenda-redo-command\n                  (list 'org-tags-view `(quote ,todo-only)\n                        (list 'if 'current-prefix-arg nil `(quote ,org-agenda-query-string))))\n            (setq files (org-agenda-files nil 'ifmode)\n                  rtnall nil)\n            (while (setq file (pop files))\n              (catch 'nextfile\n                (org-check-agenda-file file)\n                (setq buffer (if (file-exists-p file)\n                                 (org-get-agenda-file-buffer file)\n                               (error \"No such file %s\" file)))\n                (if (not buffer)\n                    ;; If file does not exist, error message to agenda\n                    (setq rtn (list\n                               (format \"ORG-AGENDA-ERROR: No such org-file %s\" file))\n                          rtnall (append rtnall rtn))\n                  (with-current-buffer buffer\n                    (unless (derived-mode-p 'org-mode)\n                      (error \"Agenda file %s is not in `org-mode'\" file))\n                    (save-excursion\n                      (save-restriction\n                        (if org-agenda-restrict\n                            (narrow-to-region org-agenda-restrict-begin\n                                              org-agenda-restrict-end)\n                          (widen))\n                        (setq rtn (org-scan-tags 'sacha/org-agenda-project-agenda matcher todo-only))\n                        (setq rtnall (append rtnall rtn))))))))\n            (if org-agenda-overriding-header\n                (insert (org-add-props (copy-sequence org-agenda-overriding-header)\n                            nil 'face 'org-agenda-structure) \"\\n\")\n              (insert \"Headlines with TAGS match: \")\n              (add-text-properties (point-min) (1- (point))\n                                   (list 'face 'org-agenda-structure\n                                         'short-heading\n                                         (concat \"Match: \" match)))\n              (setq pos (point))\n              (insert match \"\\n\")\n              (add-text-properties pos (1- (point)) (list 'face 'org-warning))\n              (setq pos (point))\n              (unless org-agenda-multi\n                (insert \"Press `C-u r' to search again with new search string\\n\"))\n              (add-text-properties pos (1- (point)) (list 'face 'org-agenda-structure)))\n            (org-agenda-mark-header-line (point-min))\n            (when rtnall\n              (insert (mapconcat 'identity rtnall \"\\n\") \"\"))\n            (goto-char (point-min))\n            (or org-agenda-multi (org-agenda-fit-window-to-buffer))\n            (add-text-properties (point-min) (point-max)\n                                 `(org-agenda-type tags\n                                                   org-last-args (,todo-only ,match)\n                                                   org-redo-cmd ,org-agenda-redo-command\n                                                   org-series-cmd ,org-cmd))\n            (org-agenda-finalize)\n            (setq buffer-read-only t)))))\n#+end_src\n\n# <<agenda_commands>>\n\n**** Org agenda custom commands\n\nThere are quite a few custom commands here, and I often forget to use\nthem. =) But it's good to define them, and over time, I'll get the\nhang of using these more!\n\n| Key         | Description                                                                                    |\n| .           | What am I waiting for?                                                                         |\n| T           | Not really an agenda command - shows the to-do tree in the current file                        |\n| b           | Shows business-related tasks                                                                   |\n| o           | Shows personal tasks and miscellaneous tasks (o: organizer)                                    |\n| w           | Show all tasks for the upcoming week                                                           |\n| W           | Show all tasks for the upcoming week, aside from the routine ones                              |\n| g ...       | Show tasks by context: b - business; c - coding; w - writing; p - phone; d - drawing, h - home |\n| 0           | Show common contexts with up to 3 tasks each, so that I can choose what I feel like working on |\n| ) (shift-0) | Show common contexts with all the tasks associated with them                                   |\n| 9           | Show common contexts with up to 3 unscheduled tasks each                                       |\n| ( (shift-9) | Show common contexts with all the unscheduled tasks associated with them                       |\n| d           | Timeline for today (agenda, clock summary)                                                     |\n| u           | Unscheduled tasks to do if I have free time                                                    |\n| U           | Unscheduled tasks that are not part of projects                                                |\n| P           | Tasks by priority                                                                              |\n| p           | My projects                                                                                    |\n| 2           | Projects with tasks                                                                            |\n\n#+begin_src emacs-lisp\n    (defvar sacha/org-agenda-contexts\n      '((tags-todo \"+@phone\")\n        (tags-todo \"+@work\")\n        (tags-todo \"+@drawing\")\n        (tags-todo \"+@coding\")\n        (tags-todo \"+@writing\")\n        (tags-todo \"+@computer\")\n        (tags-todo \"+@home\")\n        (tags-todo \"+@errands\"))\n      \"Usual list of contexts.\")\n    (defun sacha/org-agenda-skip-scheduled ()\n      (org-agenda-skip-entry-if 'scheduled 'deadline 'regexp \"\\n]+>\"))\n    (setq org-agenda-custom-commands\n          `((\"T\" todo-tree \"TODO\")\n            (\"b\" todo \"\"\n             ((org-agenda-files '(\"~/personal/business.org\"))))\n            (\"o\" todo \"\"\n             ((org-agenda-files '(\"~/personal/organizer.org\"))))\n            (\"c\" todo \"\"\n             ((org-agenda-prefix-format \"\")\n              (org-agenda-cmp-user-defined 'sacha/org-sort-agenda-items-todo)\n              (org-agenda-view-columns-initially t)\n              ))\n            ;; Weekly review\n            (\"w\" \"Weekly review\" agenda \"\"\n             ((org-agenda-span 7)\n              (org-agenda-log-mode 1)))\n            (\"W\" \"Weekly review sans routines\" agenda \"\" \n             ((org-agenda-span 7) \n              (org-agenda-log-mode 1)\n              (org-agenda-tag-filter-preset '(\"-routine\"))))\n            (\"2\" \"Bi-weekly review\" agenda \"\" ((org-agenda-span 14) (org-agenda-log-mode 1)))\n            (\"gb\" \"Business\" todo \"\"  \n             ((org-agenda-files '(\"~/personal/business.org\"))\n              (org-agenda-view-columns-initially t)))\n            (\"gc\" \"Coding\" tags-todo \"@coding\" \n             ((org-agenda-view-columns-initially t)))\n            (\"gw\" \"Writing\" tags-todo \"@writing\"\n             ((org-agenda-view-columns-initially t)))\n            (\"gp\" \"Phone\" tags-todo \"@phone\"\n             ((org-agenda-view-columns-initially t)))\n            (\"gd\" \"Drawing\" tags-todo \"@drawing\"\n             ((org-agenda-view-columns-initially t)))\n            (\"gh\" \"Home\" tags-todo \"@home\"\n             ((org-agenda-view-columns-initially t)))\n            (\"ge\" \"Errands\" tags-todo \"@errands\"\n             ((org-agenda-view-columns-initially t)))\n            (\"0\" \"Top 3 by context\"\n             ,sacha/org-agenda-contexts\n             ((org-agenda-sorting-strategy '(priority-up effort-down))\n              (sacha/org-agenda-limit-items 3)))\n            (\")\" \"All by context\"\n             ,sacha/org-agenda-contexts\n             ((org-agenda-sorting-strategy '(priority-down effort-down))\n              (sacha/org-agenda-limit-items nil)))\n            (\"9\" \"Unscheduled top 3 by context\"\n             ,sacha/org-agenda-contexts\n             ((org-agenda-skip-function 'sacha/org-agenda-skip-scheduled)\n              (org-agenda-sorting-strategy '(priority-down effort-down))\n              (sacha/org-agenda-limit-items 3)))\n            (\"(\" \"All unscheduled by context\"\n             ,sacha/org-agenda-contexts\n             ((org-agenda-skip-function 'sacha/org-agenda-skip-scheduled)\n              (org-agenda-sorting-strategy '(priority-down effort-down))\n              ))\n            (\"d\" \"Timeline for today\" ((agenda \"\" ))\n             ((org-agenda-ndays 1)\n              (org-agenda-show-log t)\n              (org-agenda-log-mode-items '(clock closed))\n              (org-agenda-clockreport-mode t)\n              (org-agenda-entry-types '())))\n            (\".\" \"Waiting for\" todo \"WAITING\")\n            (\"u\" \"Unscheduled tasks\" tags-todo \"-someday-TODO=\\\"SOMEDAY\\\"-TODO=\\\"DELEGATED\\\"-TODO=\\\"WAITING\\\"-project\"\n             ((org-agenda-skip-function 'sacha/org-agenda-skip-scheduled)\n              (org-agenda-view-columns-initially t)\n              (org-tags-exclude-from-inheritance '(\"project\"))\n              (org-agenda-overriding-header \"Unscheduled TODO entries: \")\n              (org-columns-default-format \"%50ITEM %TODO %3PRIORITY %Effort{:} %TAGS\")\n              (org-agenda-sorting-strategy '(todo-state-up priority-down effort-up tag-up category-keep))))\n            (\"U\" \"Unscheduled tasks outside projects\" tags-todo \"-project\"\n             ((org-agenda-skip-function 'sacha/org-agenda-skip-scheduled)\n              (org-tags-exclude-from-inheritance nil)\n              (org-agenda-view-columns-initially t)\n              (org-agenda-overriding-header \"Unscheduled TODO entries outside projects: \")\n              (org-agenda-sorting-strategy '(todo-state-up priority-down tag-up category-keep effort-down))))\n            (\"P\" \"By priority\"\n             ((tags-todo \"+PRIORITY=\\\"A\\\"\")\n              (tags-todo \"+PRIORITY=\\\"B\\\"\")\n              (tags-todo \"+PRIORITY=\\\"\\\"\")\n              (tags-todo \"+PRIORITY=\\\"C\\\"\"))\n             ((org-agenda-prefix-format \"%-10c %-10T %e \")\n              (org-agenda-sorting-strategy '(priority-down tag-up category-keep effort-down))))\n            (\"pp\" tags \"+project-someday-TODO=\\\"DONE\\\"\"\n             ((org-tags-exclude-from-inheritance '(\"project\"))\n              (org-agenda-sorting-strategy '(priority-down tag-up category-keep effort-down))))\n            (\"p.\" tags \"+project-TODO=\\\"DONE\\\"\"\n             ((org-tags-exclude-from-inheritance '(\"project\"))\n              (org-agenda-sorting-strategy '(priority-down tag-up category-keep effort-down))))\n            (\"S\" tags-todo \"TODO=\\\"STARTED\\\"\")\n            (\"2\" \"List projects with tasks\" sacha/org-agenda-projects-and-tasks\n             \"+PROJECT\"\n               ((sacha/org-agenda-limit-items 3)))))\n  (bind-key \"<apps> a\" 'org-agenda)\n#+end_src\n**** Make it easy to mark a task as done\n\nGreat for quickly going through the to-do list. Gets rid of one\nextra keystroke. ;)\n\n#+begin_src emacs-lisp\n(defun sacha/org-agenda-done (&optional arg)\n  \"Mark current TODO as done.\nThis changes the line at point, all other lines in the agenda referring to\nthe same tree node, and the headline of the tree node in the Org-mode file.\"\n  (interactive \"P\")\n  (org-agenda-todo \"DONE\"))\n;; Override the key definition for org-exit\n(define-key org-agenda-mode-map \"x\" 'sacha/org-agenda-done)\n#+end_src\n\n**** Make it easy to mark a task as done and create a follow-up task\n\n#+begin_src emacs-lisp\n  (defun sacha/org-agenda-mark-done-and-add-followup ()\n    \"Mark the current TODO as done and add another task after it.\nCreates it at the same level as the previous task, so it's better to use\nthis with to-do items than with projects or headings.\"\n    (interactive)\n    (org-agenda-todo \"DONE\")\n    (org-agenda-switch-to)\n    (org-capture 0 \"t\"))\n;; Override the key definition\n(define-key org-agenda-mode-map \"X\" 'sacha/org-agenda-mark-done-and-add-followup)\n#+end_src\n\n**** Capture something based on the agenda\n\n#+begin_src emacs-lisp\n(defun sacha/org-agenda-new ()\n  \"Create a new note or task at the current agenda item.\nCreates it at the same level as the previous task, so it's better to use\nthis with to-do items than with projects or headings.\"\n  (interactive)\n  (org-agenda-switch-to)\n  (org-capture 0))\n;; New key assignment\n(define-key org-agenda-mode-map \"N\" 'sacha/org-agenda-new)\n#+end_src\n\n**** Sorting by date and priority\n\n#+begin_src emacs-lisp\n  (setq org-agenda-sorting-strategy\n        '((agenda time-up priority-down tag-up effort-up category-keep)\n          (todo user-defined-up todo-state-up priority-down effort-up)\n          (tags user-defined-up)\n          (search category-keep)))\n  (setq org-agenda-cmp-user-defined 'sacha/org-sort-agenda-items-user-defined)    \n  (require 'cl)\n  (defun sacha/org-get-context (txt)\n    \"Find the context.\"\n    (car (member-if\n          (lambda (item) (string-match \"@\" item))\n          (get-text-property 1 'tags txt))))\n  \n  (defun sacha/org-compare-dates (a b)\n    \"Return 1 if A should go after B, -1 if B should go after A, or 0 if a = b.\"\n    (cond\n     ((and (= a 0) (= b 0)) nil)\n     ((= a 0) 1)\n     ((= b 0) -1)\n     ((> a b) 1)\n     ((< a b) -1)\n     (t nil)))\n  \n  (defun sacha/org-complete-cmp (a b)\n    (let* ((state-a (or (get-text-property 1 'todo-state a) \"\"))\n           (state-b (or (get-text-property 1 'todo-state b) \"\")))\n      (or\n       (if (member state-a org-done-keywords-for-agenda) 1)\n       (if (member state-b org-done-keywords-for-agenda) -1))))\n  \n  (defun sacha/org-date-cmp (a b)\n    (let* ((sched-a (or (get-text-property 1 'org-scheduled a) 0))\n           (sched-b (or (get-text-property 1 'org-scheduled b) 0))\n           (deadline-a (or (get-text-property 1 'org-deadline a) 0))\n           (deadline-b (or (get-text-property 1 'org-deadline b) 0)))\n      (or\n       (sacha/org-compare-dates\n        (sacha/org-min-date sched-a deadline-a)\n        (sacha/org-min-date sched-b deadline-b)))))\n  \n  (defun sacha/org-min-date (a b)\n    \"Return the smaller of A or B, except for 0.\"\n    (funcall (if (and (> a 0) (> b 0)) 'min 'max) a b))\n  \n  (defun sacha/org-sort-agenda-items-user-defined (a b)\n    ;; compare by deadline, then scheduled date; done tasks are listed at the very bottom\n    (or\n     (sacha/org-complete-cmp a b)\n     (sacha/org-date-cmp a b)))\n  \n  (defun sacha/org-context-cmp (a b)\n    \"Compare CONTEXT-A and CONTEXT-B.\"\n    (let ((context-a (sacha/org-get-context a))\n          (context-b (sacha/org-get-context b)))\n      (cond\n       ((null context-a) +1)\n       ((null context-b) -1)\n       ((string< context-a context-b) -1)\n       ((string< context-b context-a) +1)\n       (t nil))))\n  \n  (defun sacha/org-sort-agenda-items-todo (a b)\n    (or\n     (org-cmp-time a b)\n     (sacha/org-complete-cmp a b)\n     (sacha/org-context-cmp a b)\n     (sacha/org-date-cmp a b)\n     (org-cmp-todo-state a b)\n     (org-cmp-priority a b)\n     (org-cmp-effort a b)))\n#+end_src\n     \n**** Preventing things from falling through the cracks\nThis helps me keep track of unscheduled tasks, because I sometimes\nforget to assign tasks a date. I also want to keep track of stuck projects.\n#+begin_src emacs-lisp\n(defun sacha/org-agenda-list-unscheduled (&rest ignore)\n  \"Create agenda view for tasks that are unscheduled and not done.\"\n  (let* ((org-agenda-todo-ignore-with-date t)\n	 (org-agenda-overriding-header \"List of unscheduled tasks: \"))\n    (org-agenda-get-todos)))\n(setq org-stuck-projects\n      '(\"+PROJECT-MAYBE-DONE\"\n        (\"TODO\")\n        nil\n        \"\\\\<IGNORE\\\\>\"))\n#+end_src\n\n*** Weekly review\n\n<<weekly-review>>\n\n:PROPERTIES:\n:CUSTOM_ID: weekly-review\n:END:\n\nI regularly post [[http://sachachua.com/blog/category/weekly][weekly reviews]] to keep track of what I'm done, remind me to plan for the upcoming week, and list blog posts, sketches, and links. I \n\n\nI want to try out grouping tasks by topic first, then breaking it\ndown into previous/next week.\n\n#+begin_src emacs-lisp\n  (defvar sacha/weekly-review-line-regexp \n    \"^  \\\\([^:]+\\\\): +\\\\(Sched[^:]+: +\\\\)?TODO \\\\(.*?\\\\)\\\\(?:[      ]+\\\\(:[[:alnum:]_@#%:]+:\\\\)\\\\)?[        ]*$\"\n    \"Regular expression matching lines to include.\")\n  (defvar sacha/weekly-done-line-regexp \n    \"^  \\\\([^:]+\\\\): +.*?\\\\(?:Clocked\\\\|Closed\\\\):.*?\\\\(?:TODO\\\\|DONE\\\\) \\\\(.*?\\\\)\\\\(?:[       ]+\\\\(:[[:alnum:]_@#%:]+:\\\\)\\\\)?[        ]*$\"\n    \"Regular expression matching lines to include as completed tasks.\")\n\n  (defun sacha/quantified-get-hours (category time-summary)\n    \"Return the number of hours based on the time summary.\"\n    (if (stringp category)\n        (if (assoc category time-summary) (/ (cdr (assoc category time-summary)) 3600.0) 0)\n      (apply '+ (mapcar (lambda (x) (sacha/quantified-get-hours x time-summary)) category))))\n\n  (defun sacha/org-summarize-focus-areas ()\n    \"Summarize previous and upcoming tasks as a list.\"\n    (interactive)\n    (let ((base-date (apply 'encode-time (org-read-date-analyze \"-fri\" nil '(0 0 0))))\n          (line-re sacha/weekly-review-line-regexp)\n          (done-re sacha/weekly-done-line-regexp)\n          business relationships life business-next relationships-next life-next string \n          start end time-summary biz-time)\n      (setq start (format-time-string \"%Y-%m-%d\" (days-to-time (- (time-to-number-of-days base-date) 6))))\n      (setq end (format-time-string \"%Y-%m-%d\" (days-to-time (1+ (time-to-number-of-days base-date)))))\n      (setq time-summary (quantified-summarize-time start end))\n      (setq biz-time (sacha/quantified-get-hours \"Business\" time-summary))\n      (save-window-excursion\n        (org-agenda nil \"w\")\n        (setq string (buffer-string))\n        (with-temp-buffer\n          (insert string)\n          (goto-char (point-min))\n          (while (re-search-forward line-re nil t)\n            (cond\n             ((string= (match-string 1) \"routines\") nil) ; skip routine tasks\n             ((or (string= (match-string 1) \"business\") (string= (match-string 1) \"tasks\"))\n              (add-to-list 'business-next (concat \"  - [ ] \" (match-string 3))))\n             ((string= (match-string 1) \"people\")\n              (add-to-list 'relationships-next (concat \"  - [ ] \" (match-string 3))))\n             (t (add-to-list 'life-next (concat \"  - [ ] \" (match-string 3))))))))\n      (save-window-excursion\n        (org-agenda nil \"w\")\n        (org-agenda-later -1)\n        (org-agenda-log-mode 16)\n        (setq string (buffer-string))\n        ;; Get any completed tasks from the current week as well\n        (org-agenda-later 1)\n        (org-agenda-log-mode 16)\n        (setq string (concat string \"\\n\" (buffer-string)))\n        (with-temp-buffer\n          (insert string)\n          (goto-char (point-min))\n          (while (re-search-forward done-re nil t)\n            (cond\n             ((string= (match-string 1) \"routines\") nil) ; skip routine tasks\n             ((or (string= (match-string 1) \"business\") (string= (match-string 1) \"tasks\"))\n              (add-to-list 'business (concat \"  - [X] \" (match-string 2))))\n             ((string= (match-string 1) \"people\")\n              (add-to-list 'relationships (concat \"  - [X] \" (match-string 2))))\n             (t (add-to-list 'life (concat \"  - [X] \" (match-string 2))))))))\n      (setq string\n            (concat\n             (format \"- *Business* (%.1fh - %d%%)\\n\" biz-time (/ biz-time 1.68))\n             (mapconcat 'identity (sort business 'string<) \"\\n\") \"\\n\"\n             (mapconcat 'identity (sort business-next 'string<) \"\\n\")\n             \"\\n\"\n             (format \"  - *Earn* (%.1fh - %d%% of Business)\\n\"\n                     (sacha/quantified-get-hours \"Business - Earn\" time-summary)\n                     (/ (sacha/quantified-get-hours \"Business - Earn\" time-summary) (* 0.01 biz-time)))\n             (format \"  - *Build* (%.1fh - %d%% of Business)\\n\"\n                     (sacha/quantified-get-hours \"Business - Build\" time-summary)\n                     (/ (sacha/quantified-get-hours \"Business - Build\" time-summary) (* 0.01 biz-time)))\n             (format \"    - *Drawing* (%.1fh)\\n\"\n                     (sacha/quantified-get-hours '(\"Business - Build - Drawing\"\n                                                   \"Business - Build - Book review\")  time-summary))\n             (format \"    - *Delegation* (%.1fh)\\n\"\n                     (sacha/quantified-get-hours \"Business - Build - Delegation\" time-summary))\n             (format \"    - *Packaging* (%.1fh)\\n\"\n                     (sacha/quantified-get-hours \"Business - Build - Packaging\" time-summary))\n             (format \"    - *Paperwork* (%.1fh)\\n\"\n                     (sacha/quantified-get-hours \"Business - Build - Paperwork\"  time-summary))\n             (format \"  - *Connect* (%.1fh - %d%% of Business)\\n\"\n                     (sacha/quantified-get-hours \"Business - Connect\" time-summary)\n                     (/ (sacha/quantified-get-hours \"Business - Connect\" time-summary) (* 0.01 biz-time)))\n             (format \"- *Relationships* (%.1fh - %d%%)\\n\"\n                     (sacha/quantified-get-hours '(\"Discretionary - Social\"\n                                                   \"Discretionary - Family\") time-summary)\n                     (/ (sacha/quantified-get-hours '(\"Discretionary - Social\"\n                                                      \"Discretionary - Family\") time-summary) 1.68))\n             (mapconcat 'identity (sort relationships 'string<) \"\\n\") \"\\n\"\n             (mapconcat 'identity (sort relationships-next 'string<) \"\\n\")\n             \"\\n\"\n             (format \"- *Discretionary - Productive* (%.1fh - %d%%)\\n\"\n                     (sacha/quantified-get-hours \"Discretionary - Productive\" time-summary)\n                     (/ (sacha/quantified-get-hours \"Discretionary - Productive\" time-summary) 1.68))\n             (mapconcat 'identity (sort life 'string<) \"\\n\") \"\\n\"\n             (mapconcat 'identity (sort life-next 'string<) \"\\n\") \"\\n\"\n             (format \"  - *Writing* (%.1fh)\\n\"\n                     (sacha/quantified-get-hours \"Discretionary - Productive - Writing\" time-summary))\n             (format \"- *Discretionary - Play* (%.1fh - %d%%)\\n\"\n                     (sacha/quantified-get-hours \"Discretionary - Play\" time-summary)\n                     (/ (sacha/quantified-get-hours \"Discretionary - Play\" time-summary) 1.68))\n                                          ;                 (format \"- *Discretionary - Travel* (%.1fh - %d%%)\\n\"\n                                          ;                         (sacha/quantified-get-hours \"Discretionary - Travel\" time-summary)\n                                          ;                         (/ (sacha/quantified-get-hours \"Discretionary - Travel\" time-summary) 1.68))\n             (format \"- *Personal routines* (%.1fh - %d%%)\\n\"\n                     (sacha/quantified-get-hours \"Personal\" time-summary)\n                     (/ (sacha/quantified-get-hours \"Personal\" time-summary) 1.68))\n             (format \"- *Unpaid work* (%.1fh - %d%%)\\n\"\n                     (sacha/quantified-get-hours \"Unpaid work\" time-summary)\n                     (/ (sacha/quantified-get-hours \"Unpaid work\" time-summary) 1.68))\n             (format \"- *Sleep* (%.1fh - %d%% - average of %.1f per day)\\n\"\n                     (sacha/quantified-get-hours \"Sleep\" time-summary)\n                     (/ (sacha/quantified-get-hours \"Sleep\" time-summary) 1.68)\n                     (/ (sacha/quantified-get-hours \"Sleep\" time-summary) 7)\n                     )))\n      (if (called-interactively-p 'any)\n          (insert string)\n        string)))\n#+end_src\n\nI use this to put together a quick summary of how I spent my time.\n\nThe following code makes it easy to add a line:\n\n#+begin_src emacs-lisp\n(defun sacha/org-add-line-item-task (task)\n  (interactive \"MTask: \")\n  (org-insert-heading)\n  (insert \"[ ] \" task)\n  (let ((org-capture-entry '(\"t\" \"Tasks\" entry\n                             (file+headline \"~/personal/organizer.org\" \"Tasks\")\n                             \"\")))\n    (org-capture nil \"t\")\n    (insert \"TODO \" task \"\\nSCHEDULED: <\" (org-read-date) \">\")))\n(define-key org-mode-map (kbd \"C-c t\") 'sacha/org-add-line-item-task)\n#+end_src\n\nNow we put it all together...\n\n#+begin_src emacs-lisp\n  (defun sacha/org-prepare-weekly-review ()\n    \"Prepare weekly review template.\"\n    (interactive)\n    (let ((base-date (apply 'encode-time (org-read-date-analyze \"-fri\" nil '(0 0 0))))\n          start end)\n      (setq start (format-time-string \"%Y-%m-%d\" (days-to-time (- (time-to-number-of-days base-date) 6))))\n      (setq end (format-time-string \"%Y-%m-%d\" (days-to-time (1+ (time-to-number-of-days base-date)))))\n        (insert\n         (concat\n          \"*** Weekly review: Week ending \" (format-time-string \"%B %e, %Y\" base-date) \"  :weekly:\\n\"\n          \"*Blog posts*\\n\\n\"\n          \"*Sketches*\\n\\n\" \n          (sacha/flickr-export-and-extract start end) \"\\n\"\n          \"*Link round-up*\\n\\n\"\n          (sacha/evernote-export-and-extract start end)\n          \"\\n\\n*Focus areas and time review*\\n\\n\"\n          (sacha/org-summarize-focus-areas)\n          \"\\n\"))))\n#+end_src\n**** Flickr extract\n\n#+begin_src emacs-lisp\n  (defun sacha/flickr-extract-links-for-review (filename start end)\n    \"Extract Flickr titles and URLs from FILENAME from START to END.\n       The file should be a CSV downloaded by the Flickr metadata downloader.\n       Start date and end date should be strings in the form yyyy-mm-dd.\"\n    (interactive (list (read-file-name \"File: \")\n                            (org-read-date)\n                            (org-read-date)))\n         (require 'csv)\n         (let (list)\n           (with-temp-buffer\n             (insert-file-contents filename)\n             (goto-char (point-min))\n             (setq list\n                   (mapconcat\n                    (lambda (x) (concat \"- [[\" (car x) \"][\" (cdr x) \"]]\"))\n                    (sort\n                     (delq nil\n                           (mapcar (lambda (x)\n                                     (let ((title (cdr (assoc \"FileName\" x))))\n                                       (if (and (not (string< title start))\n                                                (string< title end))\n                                           (cons (cdr (assoc \"URL\" x)) title))))\n                                   (csv-parse-buffer t)))\n                     (lambda (a b) (string<  (cdr a) (cdr b))))\n                    \"\\n\"))\n             (setq list\n                   (replace-regexp-in-string \"\\\\([0-9]+\\\\)-\\\\([0-9]+\\\\)-\\\\([0-9]+\\\\)\"\n                                             \"\\\\1.\\\\2.\\\\3\" list))\n             (setq list\n                   (replace-regexp-in-string \"\\\\[\\\"\" \"[\" list))\n             (setq list\n                   (replace-regexp-in-string \"\\\"\\\\]\" \"]\" list)))\n           (if (called-interactively-p 'any)\n               (insert list)\n             list)))\n       \n       (defun sacha/flickr-export-and-extract (start end)\n         \"Download Flickr metadata and extract the relevant part.\"\n         (shell-command \"c:/sacha/dropbox/bin/flickr.bat\")\n         (sacha/flickr-extract-links-for-review \"c:/sacha/dropbox/bin/flickr_metadata.csv\" start end))\n#+end_src\n\n**** Link-related convenience functions\n\n#+begin_src emacs-lisp\n  (defun kensanata/resolve-redirect (url)\n    \"Resolve shortened URL by launching `curl --head' and parsing the result.\"\n    (let* ((curl (shell-command-to-string\n                  (format \"curl --silent --head %s\" url)))\n           (location (when (and (string-match \"^HTTP/1\\.1 301\" curl)\n                                (string-match \"^Location: \\\\(.*\\\\)\" curl))\n                       (match-string 1 curl))))\n      (or location url)))\n  \n  (defun sacha/resolve-urls-in-region (beg end)\n    \"Expand URLs between BEG and END.\"\n    (interactive \"r\")\n    (save-excursion\n      (save-restriction\n        (narrow-to-region beg end)\n        (goto-char (point-min))\n        (while (re-search-forward org-bracket-link-regexp nil t)\n          (replace-match (save-match-data (kensanata/resolve-redirect\n                                           (match-string 1))) t t nil 1))\n        (goto-char (point-min))\n        (while (re-search-forward org-link-re-with-space nil t)\n          (replace-match (save-match-data (kensanata/resolve-redirect\n                                           (match-string 0))) t t nil)))))\n  \n  (defun sacha/open-urls-in-region (beg end)\n    \"Open URLs between BEG and END.\"\n    (interactive \"r\")\n    (save-excursion\n      (save-restriction\n        (narrow-to-region beg end)\n        (goto-char (point-min))\n        (while (re-search-forward org-plain-link-re nil t)\n          (org-open-at-point)))))\n#+end_src\n\n**** Evernote-related extract\n#+begin_src emacs-lisp\n    (defun sacha/evernote-export-and-extract (start-date end-date)\n      \"Extract notes created on or after START-DATE and before END-DATE.\"\n      (let ((filename \"c:/sacha/tmp/Evernote.enex\"))\n        (call-process \n         \"c:/Program Files (x86)/Evernote/Evernote/enscript.exe\"\n         nil t t\n         \"exportNotes\"\n         \"/q\" (concat\n               \" tag:roundup\"\n               \" created:\" (replace-regexp-in-string \"-\" \"\" start-date)\n               \" -created:\" (replace-regexp-in-string \"-\" \"\" end-date))\n         \"/f\" filename)\n        (sacha/evernote-extract-links-for-review filename)))\n    \n    (defun sacha/evernote-extract-links-for-review (filename)\n      \"Extract note names and URLs from FILENAME.\n         The file should be an ENEX export.\"\n      (interactive (list (read-file-name \"File: \")\n                         (org-read-date)\n                         (org-read-date)))\n      (let (list)\n        (with-temp-buffer\n          (insert-file-contents filename)\n          (goto-char (point-min))\n          (while (re-search-forward \"<title>\\\\(.+?\\\\)</title>\\\\(.*?\\n\\\\)*?.*?href=\\\"\\\\(.*?\\\\)\\\"\" nil t)\n            (setq list\n                  (cons\n                   (cons\n                    (match-string-no-properties 1)\n                    (match-string-no-properties 3)) list))))\n        (setq list\n              (mapconcat (lambda (x)\n                           (concat \"- [[\"\n                                   (kensanata/resolve-redirect (cdr x))\n                                   \"][\" (car x) \"]]: \")) list \"\\n\"))\n              (if (called-interactively-p 'any)\n                  (insert list)\n                list)))\n#+end_src\n*** Moving lines around\n\nThis makes it easier to reorganize lines in my weekly review.\n#+begin_src emacs-lisp\n  (defun sacha/org-move-line-to-destination ()\n    \"Moves the current list item to <<destination>> in the current buffer.\"\n    (interactive)\n    (save-window-excursion\n      (save-excursion\n        (let ((string\n               (buffer-substring-no-properties\n                (line-beginning-position) (line-end-position))))\n          (delete-region (line-beginning-position) (1+ (line-end-position)))\n          (goto-char (point-min))\n          (re-search-forward \"<<destination>>\" nil t)\n          (insert \"\\n\" (make-string (- (match-beginning 0) (line-beginning-position)) ?\\ ) (s-trim string))))))\n  (bind-key \"C-c d\" 'sacha/org-move-line-to-destination org-mode-map)\n#+end_src\n\n*** Monthly reviews\n\n<<monthly-reviews>>\n\nI want to be able to see what I worked on in a month so that I can write my [[http://sachachua.com/blog/category/monthly][monthly reviews]]. This code makes it easy to display a month's clocked tasks and time. I haven't been particularly thorough in tracking time before, but now that I have a shortcut that logs in Quantified Awesome as well as in Org, I should end up clocking more.\n\n#+begin_src emacs-lisp\n  (defun sacha/org-review-month (start-date)\n    \"Review the month's clocked tasks and time.\"\n    (interactive (list (org-read-date)))\n    ;; Set to the beginning of the month\n    (setq start-date (concat (substring start-date 0 8) \"01\"))\n    (let ((org-agenda-show-log t)\n          (org-agenda-start-with-log-mode t)\n          (org-agenda-start-with-clockreport-mode t)\n          (org-agenda-clockreport-parameter-plist '(:link t :maxlevel 3)))\n      (org-agenda-list nil start-date 'month)))\n#+end_src\n\n*** Viewing, navigating, and editing the Org tree\n\n    I often cut and paste subtrees. This makes it easier to cut\n    something and paste it elsewhere in the hierarchy.\n    #+begin_src emacs-lisp\n      (eval-after-load 'org\n        '(progn\n           (bind-key \"C-c k\" 'org-cut-subtree org-mode-map)\n           (setq org-yank-adjusted-subtrees t)))\n#+end_src\n*** Fix timestamps in Flickr links\n\nPhotosync (for syncing with Flickr) can't deal with periods in filenames. Org gets confused with dashes in timestamps that are in link text. Solution? Save files with dashes, then use a little code to replace dashes in the region.\n\n#+begin_src emacs-lisp\n(defun sacha/fix-flickr-list (beg end)\n  (interactive \"r\")\n  (save-excursion (save-restriction\n    (narrow-to-region beg end)\n    (goto-char (point-min))\n    (while (re-search-forward \"\\\\([0-9]+\\\\)-\\\\([0-9]+\\\\)-\\\\([0-9]+\\\\)\" nil t)\n      (replace-match (concat (match-string 1) \".\" (match-string 2) \".\" (match-string 3)) nil t)))))\n#+end_src\n*** Organize my blog index\n\n#+begin_src emacs-lisp\n  (defun sacha/org-file-blog-index-entries (beg end location)\n    \"Copy entries into blog.org.\"\n    (interactive\n     (list\n      (if (region-active-p) (point) (line-beginning-position))\n      (if (region-active-p) (mark) (1+ (line-end-position)))\n      (let ((org-refile-targets\n             '((\"~/Dropbox/Public/sharing/blog.org\" . (:maxlevel . 3)))))\n        (org-refile-get-location \"Location\"))))\n    (let ((s\n           (replace-regexp-in-string\n            \"^ +- \"\n            \"- [X] \"\n            (buffer-substring-no-properties beg end))))\n      (save-window-excursion\n        (save-excursion\n          (find-file (nth 1 location))\n          (save-excursion\n            (save-restriction\n              (widen)\n              (goto-char (nth 3 location))\n              (looking-at org-outline-regexp)\n              (forward-line 1)\n              (insert s)\n              (org-update-statistics-cookies nil)))))))\n  (bind-key \"C-c f\" 'sacha/org-file-blog-index-entries org-mode-map)\n#+end_src\n\n*** Publishing\nTimestamps and section numbers make my published files look more\ncomplicated than they are. Let's turn them off by default.\n\n#+begin_src emacs-lisp\n(setq org-export-with-section-numbers nil)\n(setq org-html-include-timestamps nil)\n#+end_src\n\nSome code for Emacs chats:\n\n\nThis makes it easier to publish my public Dropbox files:\n\n#+begin_src emacs-lisp\n    (setq sacha/emacs-notes-directory \"c:/sacha/code/emacs-notes\")\n    (setq org-publish-project-alist\n          '((\"public\"\n             :base-directory \"c:/sacha/Dropbox/public\"\n             :publishing-directory \"c:/sacha/Dropbox/public\"\n             :publishing-function sacha/org-html-publish-to-html-trustingly\n             )\n            (\"sharing\"\n             :base-directory \"c:/sacha/Dropbox/public/sharing\"\n             :publishing-directory \"c:/sacha/Dropbox/public/sharing\"\n             :publishing-function sacha/org-html-publish-to-html-trustingly\n             )\n            (\"emacs-config\"\n             :base-directory \"c:/sacha/.emacs.d\"\n             :publishing-directory \"c:/sacha/.emacs.d\"\n             :publishing-function sacha/org-html-publish-to-html-trustingly\n             )))\n#+end_src\n\nI want to easily publish some files. If a file is in a publishing project, publish it.\n\n#+begin_src emacs-lisp\n  (defun sacha/org-publish-maybe ()\n    (interactive)\n    (save-excursion\n      (when (org-publish-get-project-from-filename\n             (buffer-file-name (buffer-base-buffer)) 'up)\n        (org-publish-current-file))))\n  (bind-key \"C-c C-p C-p\" 'sacha/org-publish-maybe org-mode-map)\n#+end_src\n**** Org2blog\n\nI use org2blog to post to my blog, which is Wordpress-based. I used to\nuse punchagan's org2blog, but there's a completely different one in\nELPA, so I figured I'd give that a try.\n\n#+begin_src emacs-lisp\n(sacha/package-install 'org2blog)\n(require 'org2blog-autoloads)\n(setq org-export-with-toc nil)\n(setq org-export-htmlize-output-type 'css)\n(defadvice org2blog/wp-post-buffer (around sacha activate)\n  (let ((org-confirm-babel-evaluate nil))\n    ad-do-it))\n#+end_src\n\n**** Publish without prompting\n\nI want to be able to export without having to say yes to code blocks all the time.\n\n#+begin_src emacs-lisp\n(defun sacha/org-html-export-trustingly ()\n  (interactive)\n  (let ((org-confirm-babel-evaluate nil))\n    (org-html-export-to-html)))\n\n(defun sacha/org-html-publish-to-html-trustingly (plist filename pub-dir)\n  (let ((org-confirm-babel-evaluate nil))\n    (org-html-publish-to-html plist filename pub-dir)))\n#+end_src\n**** Stylesheet / header\nMight as well take advantage of my stylesheet:\n\n#+begin_src emacs-lisp\n(setq org-html-head \"<link rel=\\\"stylesheet\\\" type=\\\"text/css\\\"\nhref=\\\"http://sachachua.com/blog/wp-content/themes/sacha-v3/foundation/css/foundation.min.css\\\"></link>\n<link rel=\\\"stylesheet\\\" type=\\\"text/css\\\" href=\\\"http://sachachua.com/org-export.css\\\"></link>\n<link rel=\\\"stylesheet\\\" type=\\\"text/css\\\" href=\\\"http://sachachua.com/blog/wp-content/themes/sacha-v3/style.css\\\"></link>\n<script src=\\\"http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js\\\"></script>\")\n(setq org-html-htmlize-output-type 'css)\n(setq org-src-fontify-natively t)\n#+end_src\n**** Footer\n\nMake it easy to scroll to the top:\n\n#+begin_src emacs-lisp\n(setq org-html-preamble \"<a name=\\\"top\\\" id=\\\"top\\\"></a>\")\n(setq org-html-postamble \"\n<style type=\\\"text/css\\\">\n.back-to-top {\n    position: fixed;\n    bottom: 2em;\n    right: 0px;\n    text-decoration: none;\n    color: #000000;\n    background-color: rgba(235, 235, 235, 0.80);\n    font-size: 12px;\n    padding: 1em;\n    display: none;\n}\n\n.back-to-top:hover {    \n    background-color: rgba(135, 135, 135, 0.50);\n}\n</style>\n\n<div class=\\\"back-to-top\\\">\n<a href=\\\"#top\\\">Back to top</a> | <a href=\\\"mailto:sacha@sachachua.com\\\">E-mail me</a>\n</div>\n\n<script type=\\\"text/javascript\\\">\n    var offset = 220;\n    var duration = 500;\n    jQuery(window).scroll(function() {\n        if (jQuery(this).scrollTop() > offset) {\n            jQuery('.back-to-top').fadeIn(duration);\n        } else {\n            jQuery('.back-to-top').fadeOut(duration);\n        }\n    });\n</script>\")\n#+end_src\n\n**** Copy region\nSometimes I want a region's HTML in my kill-ring/clipboard without any of the extra fluff:\n\n#+begin_src emacs-lisp\n  (defun sacha/org-copy-region-as-html (beg end &optional level)\n    \"Make it easier to copy code for Wordpress posts and other things.\"\n    (interactive \"r\\np\")\n    (let ((org-export-html-preamble nil)\n          (org-html-toplevel-hlevel (or level 3)))\n      (kill-new\n       (org-export-string-as (buffer-substring beg end) 'html t))))\n#+end_src\n\nSometimes I want a subtree:\n\n#+begin_src emacs-lisp\n(defun sacha/org-copy-subtree-as-html ()\n  (interactive)\n  (sacha/org-copy-region-as-html\n   (org-back-to-heading)\n   (org-end-of-subtree)))\n#+end_src\n**** UTF-8 checkboxes\n\nThis snippet turns =- [X]= into  and =- [ ]= into , but leaves =[-]= alone. \n#+begin_src emacs-lisp\n(setq org-html-checkbox-types 'unicode)\n(setq org-html-checkbox-types\n '((unicode (on . \"<span class=\\\"task-done\\\">&#x2611;</span>\") \n            (off . \"<span class=\\\"task-todo\\\">&#x2610;</span>\") \n            (trans . \"<span class=\\\"task-in-progress\\\">[-]</span>\"))))\n#+end_src\n\n*** Structure templates\n\nOrg makes it easy to insert blocks by typing =<s[TAB]=, etc.\nI hardly ever use LaTeX, but I insert a lot of Emacs Lisp blocks, so I\nredefine =<l= to insert a Lisp block instead.\n\n#+begin_src emacs-lisp\n  (setq org-structure-template-alist \n        '((\"s\" \"#+begin_src ?\\n\\n#+end_src\" \"<src lang=\\\"?\\\">\\n\\n</src>\")\n          (\"e\" \"#+begin_example\\n?\\n#+end_example\" \"<example>\\n?\\n</example>\")\n          (\"q\" \"#+begin_quote\\n?\\n#+end_quote\" \"<quote>\\n?\\n</quote>\")\n          (\"v\" \"#+BEGIN_VERSE\\n?\\n#+END_VERSE\" \"<verse>\\n?\\n</verse>\")\n          (\"c\" \"#+BEGIN_COMMENT\\n?\\n#+END_COMMENT\")\n          (\"l\" \"#+begin_src emacs-lisp\\n?\\n#+end_src\" \"<src lang=\\\"emacs-lisp\\\">\\n?\\n</src>\")\n          (\"L\" \"#+latex: \" \"<literal style=\\\"latex\\\">?</literal>\")\n          (\"h\" \"#+begin_html\\n?\\n#+end_html\" \"<literal style=\\\"html\\\">\\n?\\n</literal>\")\n          (\"H\" \"#+html: \" \"<literal style=\\\"html\\\">?</literal>\")\n          (\"a\" \"#+begin_ascii\\n?\\n#+end_ascii\")\n          (\"A\" \"#+ascii: \")\n          (\"i\" \"#+index: ?\" \"#+index: ?\")\n          (\"I\" \"#+include %file ?\" \"<include file=%file markup=\\\"?\\\">\")))\n#+end_src\n*** Quick links\n    #+begin_src emacs-lisp\n    (setq org-link-abbrev-alist\n      '((\"google\" . \"http://www.google.com/search?q=\")\n	(\"gmap\" . \"http://maps.google.com/maps?q=%s\")\n	(\"blog\" . \"http://sachachua.com/blog/p/\")))\n#+end_src\n*** Speed commands\n\nThese are great for quickly acting on tasks.\n\n#+begin_src emacs-lisp\n(setq org-use-effective-time t)\n(setq org-use-speed-commands t)\n(add-to-list 'org-speed-commands-user '(\"x\" org-todo \"DONE\"))\n(add-to-list 'org-speed-commands-user '(\"y\" org-todo-yesterday \"DONE\"))\n(add-to-list 'org-speed-commands-user '(\"!\" sacha/org-clock-in-and-track))\n(add-to-list 'org-speed-commands-user '(\"s\" call-interactively 'org-schedule))\n(add-to-list 'org-speed-commands-user '(\"i\" call-interactively 'org-clock-in))\n(add-to-list 'org-speed-commands-user '(\"o\" call-interactively 'org-clock-out))\n(bind-key \"!\" 'sacha/org-clock-in-and-track org-agenda-mode-map)\n#+end_src\n\n*** Attachments\n\nOrg lets you attach files to an Org file. Haven't gotten the hang of this yet, but looks interesting.\n\n#+begin_src emacs-lisp\n(setq org-attach-store-link-p 'attached)\n(setq org-attach-auto-tag nil)\n#+end_src\n\n*** Counting\n\nGood way to remind myself that I have lots of STARTED tasks.\n\n#+begin_src emacs-lisp\n(defun sacha/org-summarize-task-status ()\n  \"Count number of tasks by status. \nProbably should make this a dblock someday.\"\n  (interactive)\n  (let (result)\n    (org-map-entries\n     (lambda ()\n       (let ((todo (elt (org-heading-components) 2)))\n         (if todo\n             (if (assoc todo result)\n                 (setcdr (assoc todo result)\n                         (1+ (cdr (assoc todo result))))\n               (setq result (cons (cons todo 1) result)))))))\n    (message \"%s\" (mapconcat (lambda (x) (format \"%s: %d\" (car x) (cdr x)))\n                             result \"\\n\"))))\n#+end_src\n*** Diagrams and graphics\n\nOoooh. Graphviz and Ditaa make it easier to create diagrams from Emacs. See [[http://sachachua.com/evil-plans]] for examples and source.\n\n#+begin_src emacs-lisp\n  (setq org-ditaa-jar-path \"C:/Sacha/Dropbox/bin/ditaa.jar\")\n  (setq org-startup-with-inline-images t)\n  (add-hook 'org-babel-after-execute-hook 'org-display-inline-images)\n  (org-babel-do-load-languages\n   'org-babel-load-languages\n   '((dot . t)\n     (ditaa . t) \n     (R . t)))\n  (add-to-list 'org-src-lang-modes '(\"dot\" . graphviz-dot))\n#+end_src\n*** Presentations\n#+begin_src emacs-lisp\n(use-package ox-reveal)\n#+end_src\n*** Share my Emacs configuration\n\nThis code gets around the fact that my config is called Sacha.org, but\nI want it to export as sacha-emacs.org in my Dropbox's public\ndirectory. Although now that I'm shifting to Github Pages, maybe I\ndon't need this any more...\n\n#+begin_src emacs-lisp\n  (defun sacha/org-share-emacs ()\n    \"Share my Emacs configuration.\"\n    (interactive)\n    (let* ((destination-dir \"~/Dropbox/Public/\")\n           (destination-filename \"sacha-emacs.org\"))\n      (save-restriction\n        (save-excursion\n          (widen)\n          (write-region (point-min) (point-max) \n            (expand-file-name destination-filename destination-dir))\n          (with-current-buffer (find-file-noselect (expand-file-name\n                                                    destination-filename destination-dir))\n            (org-babel-tangle-file buffer-file-name \n                                   (expand-file-name\n                                    \"sacha-emacs.el\" destination-dir) \"emacs-lisp\")\n            (org-html-export-to-html))))))\n    #+end_src\n*** Task dependencies\n\n#+begin_src emacs-lisp\n(setq org-enforce-todo-dependencies t)\n(setq org-track-ordered-property-with-tag t)\n#+end_src\n** Coding\n*** Tab width of 2 is compact and readable\n#+begin_src emacs-lisp\n    (setq-default tab-width 2)\n#+end_src\n*** New lines are always indented\n\nI almost always want to go to the right indentation on the next line.\n#+begin_src emacs-lisp\n(global-set-key (kbd \"RET\") 'newline-and-indent)\n#+end_src\n\n*** Adapt to being on Windows\n\nI'm on Windows, so I use Cygwin to add Unix-y tools to make my life easier. \nThese config snippets seem to help too.\n#+begin_src emacs-lisp\n  (add-hook 'comint-output-filter-functions\n      'shell-strip-ctrl-m nil t)\n  (add-hook 'comint-output-filter-functions\n      'comint-watch-for-password-prompt nil t)\n#+end_src\n\n*** Expand region\n\nThis is something I have to get the hang of too. It gradually expands the selection. Handy for Emacs Lisp.\n\n#+begin_src emacs-lisp\n  (sacha/package-install 'expand-region)\n  (use-package expand-region\n    :bind (\"C-=\" . er/expand-region))\n#+end_src\n*** Emacs Lisp\n**** Edebug\n\nDid you know edebug has a trace function? I didn't. Thanks, agumonkey!\n\n#+begin_src emacs-lisp\n(setq edebug-trace t)\n#+end_src\n\nWhile edebugging, use T to view a trace buffer (=*edebug-trace*=).\nEmacs will quickly execute the rest of your code, printing out the\narguments and return values for each expression it evaluates.\n\n**** Eldoc\nEldoc provides minibuffer hints when working with Emacs Lisp.\n#+begin_src emacs-lisp\n    (autoload 'turn-on-eldoc-mode \"eldoc\" nil t)\n    (add-hook 'emacs-lisp-mode-hook 'turn-on-eldoc-mode)\n    (add-hook 'lisp-interaction-mode-hook 'turn-on-eldoc-mode)\n    (add-hook 'ielm-mode-hook 'turn-on-eldoc-mode)\n#+end_src\n**** Refactoring  :drill:\n     SCHEDULED: <2013-03-03 Sun>\n     :PROPERTIES:\n     :ID:       99ac7ddb-08ef-46c4-8fa8-8a45164f9ef4\n     :DRILL_LAST_INTERVAL: 3.86\n     :DRILL_REPEATS_SINCE_FAIL: 2\n     :DRILL_TOTAL_REPEATS: 2\n     :DRILL_FAILURE_COUNT: 1\n     :DRILL_AVERAGE_QUALITY: 2.5\n     :DRILL_EASE: 2.36\n     :DRILL_LAST_QUALITY: 3\n     :DRILL_LAST_REVIEWED: [2013-02-27 Wed 21:18]\n     :END:\n\nMore things that I need to get used to...\n\n#+begin_src emacs-lisp\n;; C-c C-v l : elint current buffer in clean environment.\n;; C-c C-v L : elint current buffer by multiple emacs binaries.\n;;             See `erefactor-lint-emacsen'\n;; C-c C-v r : Rename symbol in current buffer.\n;;             Resolve `let' binding as long as i can.\n;; C-c C-v R : Rename symbol in requiring modules and current buffer.\n;; C-c C-v h : Highlight current symbol in this buffer\n;;             and suppress `erefacthr-highlight-mode'.\n;; C-c C-v d : Dehighlight all by above command.\n;; C-c C-v c : Switch prefix bunch of symbols.\n;;             ex: '(hoge-var hoge-func) -> '(foo-var foo-func)\n;; C-c C-v ? : Display flymake elint warnings/errors\n\n  (use-package erefactor\n    :config\n    (define-key emacs-lisp-mode-map \"\\C-c\\C-v\" erefactor-map))\n#+end_src\n**** Jumping to code\n\n#+begin_src emacs-lisp\n(define-key emacs-lisp-mode-map (kbd \"C-c .\") 'find-function-at-point)\n#+end_src\n*** Snippets\n    #+begin_src emacs-lisp\n      (use-package yasnippet-bundle\n        :init\n        (progn\n          (yas/initialize)\n          (yas/load-directory \"~/elisp/snippets\")\n          (setq yas/key-syntaxes '(\"w_\" \"w_.\" \"^ \"))))\n      ;;        (global-set-key (kbd \"C-c y\") (lambda () (interactive)\n      ;;                                         (yas/load-directory \"~/elisp/snippets\")))\n#+end_src\n*** Show column number\n\nI sometimes need to know where I am in a line.\n    #+begin_src emacs-lisp\n(column-number-mode 1)\n#+end_src\n\n*** Don't show whitespace in diff, but show context\n    #+begin_src emacs-lisp\n    (setq vc-diff-switches '(\"-b\" \"-B\" \"-u\"))\n#+end_src\n*** Javascript\n#+begin_src emacs-lisp\n      (use-package js2-mode\n        :commands js2-mode\n        :init\n          (add-to-list 'auto-mode-alist '(\"\\\\.js$\" . js2-mode))\n        :config\n        (progn \n          (bind-key \"C-x C-e\" 'js-send-last-sexp js2-mode-map)\n          (bind-key \"C-M-x\" 'js-send-last-sexp-and-go js2-mode-map)\n          (bind-key \"C-c b\" 'js-send-buffer js2-mode-map)\n          (bind-key \"C-c C-b\" 'js-send-buffer-and-go js2-mode-map)\n          (bind-key \"C-c l\" 'js-load-file-and-go js2-mode-map)))\n#+end_src\n\n*** Magit - nice git interface\n\n#+begin_src emacs-lisp\n(defun sacha/magit-commit-all ()\n  \"Publish the current file and commit all the current changes.\"\n  (interactive)\n  (sacha/org-publish-maybe)\n  (magit-status default-directory)\n  (magit-stage-all)\n  (call-interactively 'magit-log-edit))\n\n(use-package magit\n  :init (setq magit-diff-options '(\"-b\")) ; ignore whitespace\n  :bind ((\"C-x v d\" . magit-status) \n         (\"C-x v p\" . magit-push) \n         (\"C-x v c\" . sacha/magit-commit-all)))\n#+end_src\n*** Tag files\n\n    I don't often use a TAGS file, but when I do, I don't want to have\n    to set my tags file per project. I search for it in the directory\n    tree instead.\n    \n    #+begin_src emacs-lisp\n      (defun sacha/recursive-find-file (file &optional directory)\n        \"Find the first FILE in DIRECTORY or its parents.\"\n        (setq directory (or directory (file-name-directory (buffer-file-name)) (pwd)))\n        (if (file-exists-p (expand-file-name file directory))\n            (expand-file-name file directory)\n          (unless (string= directory \"/\")\n            (sacha/recursive-find-file file (expand-file-name \"..\" directory)))))\n      \n      (defun sacha/find-tags ()\n        \"Set the TAGS file.\"\n        (set (make-variable-buffer-local 'tags-table-list) nil)\n        (set (make-variable-buffer-local 'tags-file-name) \n             (sacha/recursive-find-file \"TAGS\")))\n      \n      (eval-after-load 'drupal-mode\n        '(progn\n           (add-hook 'drupal-mode-hook 'sacha/find-tags)))\n      #+end_src\n*** Projects\n\n#+begin_src emacs-lisp\n(setq projectile-keymap-prefix (kbd \"C-c C-p\")) \n(use-package projectile\n  :init \n  (progn\n    (projectile-global-mode)\n    (setq projectile-enable-caching t)))\n(use-package helm-projectile)\n#+end_src\n*** Exploring MELPA recipes\n\n#+begin_src emacs-lisp\n\n#+end_src\n\n** Ledger (personal finance): Make it easier to review my credit card transactions\n\n#+begin_src emacs-lisp\n(defun sacha/ledger-go-to-beginning-of-entry ()\n  \"Move to the beginning of the current entry.\"\n  (while (and (not (bobp))\n              (eq (ledger-context-line-type (ledger-context-at-point))\n                  'acct-transaction))\n    (forward-line -1)))\n\n(defun sacha/ledger-entry-date ()\n  \"Returns the date of the entry containing point or nil.\"\n  (save-excursion\n    (sacha/ledger-go-to-beginning-of-entry)\n    (let ((context-info (ledger-context-other-line 0)))\n      (when (eq (ledger-context-line-type context-info) 'entry)\n        (goto-char (line-beginning-position))\n        (if (looking-at \"\\\\([-0-9\\\\./]+\\\\)\")\n            (match-string-no-properties 1))))))\n\n(defun sacha/ledger-guess-mbna ()\n  \"Adds a sub-account for the dates for my credit card transactions.\"\n  (interactive)\n  (save-excursion\n    (sacha/ledger-go-to-beginning-of-entry)\n    (forward-line 1)\n    (let ((amount 0) (date (sacha/ledger-entry-date)) month)\n      (if (string-match \"[0-9]+[-\\\\.]\\\\([0-9]+\\\\)[-\\\\.]\\\\([0-9]+\\\\)\" date)\n          (setq month (string-to-number (match-string 1 date))))\n      ;; Is this a payment or a charge?\n      (save-excursion\n        (while (and (eq (ledger-context-line-type (ledger-context-at-point))\n                        'acct-transaction)\n                    (not (eobp)))\n          (let ((context (ledger-context-at-point)))\n            (if (ledger-context-field-value context 'amount)\n                (if (string-match \"MBNA\" (ledger-context-field-value context 'account))\n                    (setq amount (string-to-number (ledger-context-field-value context 'amount)))\n                  (setq amount (- (string-to-number (ledger-context-field-value context 'amount)))))))\n          (forward-line 1)))\n      (save-excursion\n        (while (and (eq (ledger-context-line-type (ledger-context-at-point))\n                        'acct-transaction)\n                    (not (eobp)))\n          (let ((context (ledger-context-at-point)))\n            (if (string-match \"MBNA\" (ledger-context-field-value context 'account))\n                (if (re-search-forward \"\\\\(MBNA\\\\)[ \\t]*[-$\\.0-9]*[ \\t]*$\" (line-end-position) t)\n                    (replace-match\n                     (concat \"MBNA:\"\n                             (elt\n                              '(\"January\" \"February\" \"March\" \"April\" \"May\" \"June\" \"July\" \"August\" \"September\" \"October\" \"November\" \"December\")\n                              (% (+ (if (> amount 0) 10 11) month) 12)))\n                             t t nil 1))))\n          (forward-line 1))))))\n#+end_src\n\n** Internet Relay Chat\n\n   IRC is a great way to hang out with other Emacs geeks.\n   #+begin_src emacs-lisp\n     (use-package erc\n       :config\n       (setq erc-autojoin-channels-alist '((\"freenode.net\"\n					    \"#org-mode\"\n					    \"#hacklabto\"\n					    \"#emacs\"))\n	     erc-server \"irc.freenode.net\"\n	     erc-nick \"sachac\"))\n   #+end_src\n\n** Self-tracking, statistics, and other data transformations\n*** Quantified Awesome\n<<clock-in>>\n\n#+begin_src emacs-lisp\n  (defun sacha/org-clock-in-and-track ()\n    \"Start the clock running. Clock into Quantified Awesome.\"\n    (interactive)\n    (if (derived-mode-p 'org-agenda-mode) (org-agenda-clock-in) (org-clock-in))\n    (call-interactively 'sacha/org-quantified-track))\n  (define-key org-agenda-mode-map \"!\" 'sacha/org-clock-in-and-track)\n\n  (defun sacha/org-quantified-track (&optional category note)\n    \"Create a tracking record using CATEGORY and NOTE.\n  Default to the current task in the agenda, the currently-clocked\n  entry, or the current subtree in Org.\"\n    (interactive (list nil nil))\n    (let ((get-info \n           (lambda ()\n             (setq category (or category\n                                (org-entry-get-with-inheritance \"QUANTIFIED\")))\n             (unless category\n               (setq category (read-string \"Category: \"))\n               (org-set-property \"QUANTIFIED\" category))\n             (setq note (or note (elt (org-heading-components) 4))))))\n      (unless (and category note)\n        (cond\n         ((derived-mode-p 'org-agenda-mode)\n          (let* ((marker (org-get-at-bol 'org-marker))\n                 (buffer (marker-buffer marker))\n                 (pos (marker-position marker)))\n            (with-current-buffer buffer\n              (save-excursion\n                (save-restriction\n                  (widen)\n                  (goto-char pos)\n                  (funcall get-info))))))\n         ((org-clocking-p)(save-excursion (org-clock-goto) (funcall get-info)))\n         ((derived-mode-p 'org-mode) (funcall get-info)))\n        (setq note (or note (read-string \"Note: \"))))\n      (quantified-track (concat category \" | \" note))))\n    \n\n  (use-package quantified)\n#+end_src\n*** Compare times and effort estimates\n<<compare-time>>\n\nThis is for comparing times in column view and in tables.\n\n#+begin_src emacs-lisp\n  (defun sacha/compare-times (clocked estimated)\n    (if (and (> (length clocked) 0) estimated)\n        (format \"%.2f\"\n              (/ (* 1.0 (org-hh:mm-string-to-minutes clocked))\n                 (org-hh:mm-string-to-minutes estimated)))\n      \"\"))\n#+end_src\n\nUse with =#+COLUMNS: %40ITEM %17Effort(Estimated){:} %CLOCKSUM=, =#+BEGIN: columnview :hlines 1= ... =#+END:=, and\n\n#+begin_src org\n,#+TBLFM: $4='(sacha/compare-times $3 $2)\n#+end_src\n\n*** R\n\n#+begin_src emacs-lisp\n  (sacha/package-install 'ess)                \n  (use-package ess-site\n    :commands R)\n#+end_src\n\n*** Workrave\n    #+begin_src emacs-lisp\n    (defvar sacha/workrave-file (expand-file-name \".\\\\Workrave\\\\historystats\" (getenv \"AppData\")))\n\n(defun sacha/workrave-transform-statistics (&optional file)\n  (interactive (list sacha/workrave-file))\n  (with-current-buffer (find-file-noselect file)\n  ;; D day month-1 year hour min day month-1 year hour min\n    (let ((result \"Date\\tStart\\tEnd\\tClicks\\tKeystrokes\\n\"))\n      (goto-char (point-min))\n      (while (re-search-forward \"^D \\\\(.*\\\\)\" nil t)\n	(let ((dates (split-string (match-string 1))))\n	  (if (re-search-forward \"^m \\\\(.*\\\\)\" nil t)\n	      (let ((info (split-string (match-string 1))))\n		(setq result\n		      (concat result\n			      (format \"%d-%d-%s\\t%s:%02d\\t%s:%02d\\t%s\\t%s\\n\"\n				      (+ 1900 (string-to-number (elt dates 2))) ; year\n				      (1+ (string-to-number (elt dates 1))) ; month\n				      (elt dates 0) ; day\n				      (elt dates 3) ; start hour\n				      (string-to-number (elt dates 4)) ; start min\n				      (elt dates 8) ; end hour\n				      (string-to-number (elt dates 9)) ; end min\n				      (elt info 5) ; clicks\n				      (elt info 6) ; keystrokes\n				      )))))))\n      (if (interactive-p)\n	  (kill-new result)\n	result))))\n    #+end_src\n*** Blog\n#+begin_src emacs-lisp\n  (defun sacha/strip-blog-share ()\n    (interactive)\n    (let (base)\n      (save-excursion\n        (goto-char (point-min))\n        (while (re-search-forward \n                \"<div class=\\\"sharedaddy sd-sharing-enabled\\\">.*?<div class=\\\"sharing-clear\\\"></div></div></div></div>\" nil t)\n          (replace-match \"\")))))\n#+end_src\n*** Artrage\n\n#+begin_src emacs-lisp\n          (defun sacha/artrage-export-png (directory &optional prefix)\n            \"Change an Artrage script file (arscript) to export images to DIRECTORY. \n      If PREFIX is specified, use that instead of image-.\"\n            (interactive \"MPath: \")\n            (unless (file-directory-p directory)\n              (make-directory directory t))\n            (while (re-search-forward \"[0-9\\\\.]+s\" nil t)\n              (replace-match \"0.000s\"))\n            (goto-char (point-min))\n            (while (search-forward \"<StrokeEvent>\" nil t)\n              (replace-match (concat \n                              \"EvType: Command    CommandID: ExportLayer    Idx: -1    Channels: NO    Path: \\\"\"\n                              directory\n                              \"/\" (or prefix \"image-\")\n                              \".png\\\"\n  <StrokeEvent>\") t t)))\n    \n#+end_src\n** Workarounds\n*** color-theme sometimes comes across lists. Odd!\n\n#+begin_src emacs-lisp\n  (defadvice face-attribute (around sacha activate)\n    (if (symbolp (ad-get-arg 0))\n        ad-do-it))\n#+end_src\n\n*** ido-sort-mtime stopped working when I upgraded to Windows 8\n\n#+begin_src emacs-lisp\n  (defadvice ido-sort-mtime (around sacha activate)\n    (setq ido-temp-list\n          (sort ido-temp-list \n                (lambda (a b)\n                  (let ((ta (or (nth 5 (file-attributes (concat ido-current-directory a))) '(0 0)))\n                        (tb (or (nth 5 (file-attributes (concat ido-current-directory b))) '(0 0))))\n                    (if (= (nth 0 ta) (nth 0 tb))\n                        (> (nth 1 ta) (nth 1 tb))\n                      (> (nth 0 ta) (nth 0 tb)))))))\n    (setq ad-return-value\n          (ido-to-end  ;; move . files to end (again)\n           (delq nil (mapcar\n                      (lambda (x) (if (string-equal (substring x 0 1) \".\") x))\n                      ido-temp-list)))))\n  \n#+end_src\n*** Cygwin mogrify doesn't work for me, but ImageMagick does\n\n#+begin_src emacs-lisp\n;(setq eimp-mogrify-program \"c:/Program Files/ImageMagick-6.8.3-Q16/mogrify.exe\")\n#+end_src\n\n** Advanced stuff / things I tend to forget about\n*** Editing multiple things\n**** Multiple cursors mode					      :drill:\n     SCHEDULED: <2013-03-03 Sun>\n    :PROPERTIES:\n    :ID:       o2b:61b0ffae-669b-4360-98fd-a6f0ea6f018e\n    :DRILL_LAST_INTERVAL: 3.86\n    :DRILL_REPEATS_SINCE_FAIL: 2\n    :DRILL_TOTAL_REPEATS: 2\n    :DRILL_FAILURE_COUNT: 1\n    :DRILL_AVERAGE_QUALITY: 2.5\n    :DRILL_EASE: 2.36\n    :DRILL_LAST_QUALITY: 3\n    :DRILL_LAST_REVIEWED: [2013-02-27 Wed 21:18]\n    :END:\n\nI often define keyboard macros to process multiple lines in a region.\nMaybe =multiple-cursors= will be an even better way. Looks promising!\n[[http://emacsrocks.com/e13.html][See Emacs Rocks episode 13 (multiple-cursors) for a great demo]].\n\n#+begin_src emacs-lisp\n  (use-package multiple-cursors\n    :bind \n     ((\"C->\" . mc/mark-next-like-this)\n      (\"C-<\" . mc/mark-previous-like-this)\n      (\"C-*\" . mc/mark-all-like-this)))\n#+end_src\n\nThanks to [[http://irreal.org/blog/?p=1733][Irreal]] and [[http://planet.emacsen.org/][Planet Emacsen]] for the link!\n\n**** All							      :drill:\n     SCHEDULED: <2013-03-03 Sun>\n     :PROPERTIES:\n     :ID:       211c02ab-9a9c-4e81-bc95-ce8e48db67b1\n     :DRILL_LAST_INTERVAL: 3.86\n     :DRILL_REPEATS_SINCE_FAIL: 2\n     :DRILL_TOTAL_REPEATS: 3\n     :DRILL_FAILURE_COUNT: 2\n     :DRILL_AVERAGE_QUALITY: 2.333\n     :DRILL_EASE: 2.36\n     :DRILL_LAST_QUALITY: 3\n     :DRILL_LAST_REVIEWED: [2013-02-27 Wed 21:18]\n     :END:\n\nM-x all lets you edit all lines matching a given regexp.\n\n#+begin_src emacs-lisp\n(use-package all)\n#+end_src\n\n*** Edit list   :drill:\n    SCHEDULED: <2013-03-03 Sun>\n    :PROPERTIES:\n    :ID:       e9147cb0-bad0-421c-9396-4f9045d6ebbb\n    :DRILL_LAST_INTERVAL: 3.86\n    :DRILL_REPEATS_SINCE_FAIL: 2\n    :DRILL_TOTAL_REPEATS: 3\n    :DRILL_FAILURE_COUNT: 2\n    :DRILL_AVERAGE_QUALITY: 2.333\n    :DRILL_EASE: 2.36\n    :DRILL_LAST_QUALITY: 3\n    :DRILL_LAST_REVIEWED: [2013-02-27 Wed 21:18]\n    :END:\n\nM-x edit-list makes it easier to edit an Emacs Lisp list.\n\n#+begin_src emacs-lisp\n(use-package edit-list\n  :commands edit-list)\n#+end_src\n\n*** Ace Jump mode  :drill:\n    :PROPERTIES:\n    :ID:       56f173e7-d2a2-4589-84d7-c6b435c8a5f8\n    :DRILL_LAST_INTERVAL: 0.0\n    :DRILL_REPEATS_SINCE_FAIL: 1\n    :DRILL_TOTAL_REPEATS: 3\n    :DRILL_FAILURE_COUNT: 2\n    :DRILL_AVERAGE_QUALITY: 1.667\n    :DRILL_EASE: 2.36\n    :DRILL_LAST_QUALITY: 0\n    :DRILL_LAST_REVIEWED: [2013-03-13 Wed 09:50]\n    :END:\n\nQuickly jump to a position in the current view.\n\n#+begin_src emacs-lisp\n  (use-package ace-jump-mode\n    :bind (\"M-SPC\" . ace-jump-mode))\n  (bind-key \"M-S-SPC\" 'just-one-space)\n#+end_src\n\nAce Window looks useful too.\n\n#+begin_src emacs-lisp\n(use-package ace-window\n  :bind (\"M-s a w\" . ace-window))\n#+end_src\n\n*** Network: TRAMP and editing files over SSH\nEmacs lets you edit files on remote servers, which is pretty darn\ncool. On Windows, these things help a little.\n\n#+begin_src emacs-lisp\n(setq tramp-default-method \"plink\")\n(setq tramp-auto-save-directory \"c:\\\\sacha\\\\tmp\")\n#+end_src\n\n** Other nifty Emacs things I want to learn\n*** Finding the closest Makefile				      :drill:\n   SCHEDULED: <2013-03-05 Tue>\n   :PROPERTIES:\n   :ID:       bfdaf129-f64c-49be-8848-a0e0300fdfdb\n   :DRILL_LAST_INTERVAL: 4.14\n   :DRILL_REPEATS_SINCE_FAIL: 2\n   :DRILL_TOTAL_REPEATS: 1\n   :DRILL_FAILURE_COUNT: 0\n   :DRILL_AVERAGE_QUALITY: 5.0\n   :DRILL_EASE: 2.6\n   :DRILL_LAST_QUALITY: 5\n   :DRILL_LAST_REVIEWED: [2013-03-01 Fri 16:47]\n   :END:\n\nLook up the directory hierarchy from FILE for a file named NAME.\nStop at the first parent directory containing a file NAME,\nand return the directory.  Return nil if not found.\n\n**** Answer\n=find-dominating-file=\n\n\n*** iedit\n\n#+begin_src emacs-lisp\n(use-package iedit)\n#+end_src\n   \n*** Smartparens mode						      :drill:\n\n#+begin_src emacs-lisp\n  (use-package smartparens\n    :init \n    (progn\n      (require 'smartparens-config)\n      (add-hook 'emacs-lisp-mode-hook 'smartparens-mode)\n      (add-hook 'emacs-lisp-mode-hook 'show-smartparens-mode)\n\n  ;;;;;;;;;;;;;;;;;;;;;;;;\n      ;; keybinding management\n  \n      (define-key sp-keymap (kbd \"C-M-f\") 'sp-forward-sexp)\n      (define-key sp-keymap (kbd \"C-M-b\") 'sp-backward-sexp)\n  \n      (define-key sp-keymap (kbd \"C-M-d\") 'sp-down-sexp)\n      (define-key sp-keymap (kbd \"C-M-a\") 'sp-backward-down-sexp)\n      (define-key sp-keymap (kbd \"C-S-a\") 'sp-beginning-of-sexp)\n      (define-key sp-keymap (kbd \"C-S-d\") 'sp-end-of-sexp)\n  \n      (define-key sp-keymap (kbd \"C-M-e\") 'sp-up-sexp)\n      (define-key emacs-lisp-mode-map (kbd \")\") 'sp-up-sexp)\n      (define-key sp-keymap (kbd \"C-M-u\") 'sp-backward-up-sexp)\n      (define-key sp-keymap (kbd \"C-M-t\") 'sp-transpose-sexp)\n  \n      (define-key sp-keymap (kbd \"C-M-n\") 'sp-next-sexp)\n      (define-key sp-keymap (kbd \"C-M-p\") 'sp-previous-sexp)\n  \n      (define-key sp-keymap (kbd \"C-M-k\") 'sp-kill-sexp)\n      (define-key sp-keymap (kbd \"C-M-w\") 'sp-copy-sexp)\n  \n      (define-key sp-keymap (kbd \"M-<delete>\") 'sp-unwrap-sexp)\n      (define-key sp-keymap (kbd \"M-<backspace>\") 'sp-backward-unwrap-sexp)\n  \n      (define-key sp-keymap (kbd \"C-<right>\") 'sp-forward-slurp-sexp)\n      (define-key sp-keymap (kbd \"C-<left>\") 'sp-forward-barf-sexp)\n      (define-key sp-keymap (kbd \"C-M-<left>\") 'sp-backward-slurp-sexp)\n      (define-key sp-keymap (kbd \"C-M-<right>\") 'sp-backward-barf-sexp)\n  \n      (define-key sp-keymap (kbd \"M-D\") 'sp-splice-sexp)\n      (define-key sp-keymap (kbd \"C-M-<delete>\") 'sp-splice-sexp-killing-forward)\n      (define-key sp-keymap (kbd \"C-M-<backspace>\") 'sp-splice-sexp-killing-backward)\n      (define-key sp-keymap (kbd \"C-S-<backspace>\") 'sp-splice-sexp-killing-around)\n  \n      (define-key sp-keymap (kbd \"C-]\") 'sp-select-next-thing-exchange)\n      (define-key sp-keymap (kbd \"C-<left_bracket>\") 'sp-select-previous-thing)\n      (define-key sp-keymap (kbd \"C-M-]\") 'sp-select-next-thing)\n  \n      (define-key sp-keymap (kbd \"M-F\") 'sp-forward-symbol)\n      (define-key sp-keymap (kbd \"M-B\") 'sp-backward-symbol)\n  \n      (define-key sp-keymap (kbd \"H-t\") 'sp-prefix-tag-object)\n      (define-key sp-keymap (kbd \"H-p\") 'sp-prefix-pair-object)\n      (define-key sp-keymap (kbd \"H-s c\") 'sp-convolute-sexp)\n      (define-key sp-keymap (kbd \"H-s a\") 'sp-absorb-sexp)\n      (define-key sp-keymap (kbd \"H-s e\") 'sp-emit-sexp)\n      (define-key sp-keymap (kbd \"H-s p\") 'sp-add-to-previous-sexp)\n      (define-key sp-keymap (kbd \"H-s n\") 'sp-add-to-next-sexp)\n      (define-key sp-keymap (kbd \"H-s j\") 'sp-join-sexp)\n      (define-key sp-keymap (kbd \"H-s s\") 'sp-split-sexp)\n  \n  ;;;;;;;;;;;;;;;;;;\n      ;; pair management\n  \n      (sp-local-pair 'minibuffer-inactive-mode \"'\" nil :actions nil)\n  \n  ;;; markdown-mode\n      (sp-with-modes '(markdown-mode gfm-mode rst-mode)\n        (sp-local-pair \"*\" \"*\" :bind \"C-*\")\n        (sp-local-tag \"2\" \"**\" \"**\")\n        (sp-local-tag \"s\" \"```scheme\" \"```\")\n        (sp-local-tag \"<\"  \"<_>\" \"</_>\" :transform 'sp-match-sgml-tags))\n  \n  ;;; tex-mode latex-mode\n      (sp-with-modes '(tex-mode plain-tex-mode latex-mode)\n        (sp-local-tag \"i\" \"1d5f8e69396c521f645375107197ea4dfbc7b792quot;<\" \"1d5f8e69396c521f645375107197ea4dfbc7b792quot;>\"))\n  \n  ;;; html-mode\n      (sp-with-modes '(html-mode sgml-mode)\n        (sp-local-pair \"<\" \">\"))\n  \n  ;;; lisp modes\n      (sp-with-modes sp--lisp-modes\n        (sp-local-pair \"(\" nil :bind \"C-(\"))))\n#+end_src\n** Web browsing\n\n	 Minor tweak for Firefox on Windows. Otherwise I get \"Searching for\n	 program\" \"permission denied\" \"firefox\".\n	 \n	 #+begin_src emacs-lisp\n	 (setq browse-url-firefox-program\n         \"C:/Program Files (x86)/Mozilla Firefox/firefox.exe\")\n	 #+end_src\n** Startup\n   #+begin_src emacs-lisp\n     (find-file \"~/personal/organizer.org\")\n     (require 'org-compat)\n     (org-agenda nil \"a\")\n	 #+end_src\n* Other cool configs you may want to check out\n<<links>>\n\n- [[http://doc.norang.ca/org-mode.html][Bernt Hansen]]: Lots of Org-related config. I picked up the graph-drawing stuff from this.\n- [[http://bzg.fr/emacs.html][Bastien Guerry]]: Org, Gnus, ERC - Explained in this [[http://sachachua.com/blog/2013/05/emacs-chat-bastien-guerry/][Emacs Chat (~1h)]]\n- [[https://github.com/iani/emacs-prelude][Iannis Zannos]]: Explained in this [[https://www.youtube.com/watch?v=0F8aCbC9z3A][Emacs Chat (~1h)]]\n- [[https://github.com/magnars/.emacs.d][Magnar Sveen]]: http://whattheemacsd.com/ has some explanations. [[http://sachachua.com/blog/2013/11/emacs-chat-magnar-sveen-emacs-rocks/][Emacs Chat (~1h)]]\n- [[https://github.com/jwiegley/dot-emacs][John Wiegley]]: Also see his [[http://www.youtube.com/watch?v=RvPFZL6NJNQ][Emacs Lisp Development talk]] (sorry, sucky video) and [[http://www.youtube.com/watch?v=ytNsHmRLZGM][Emacs Chat video]]\n\n* Inactive/infrequent things\n** Beeminder\n<<beeminder>>\n\nhttps://github.com/sachac/beeminder.el\n\nThis bit of code lets me track sent messages in Gnus:\n\n#+begin_src emacs-lisp :eval no :tangle no\n(defun sacha/beeminder-track-message ()\n	(save-excursion\n		(goto-char (point-min))\n		(when (re-search-forward \"Newsgroups: .*emacs\")\n			(goto-char (point-min))\n			(when (re-search-forward \"Subject: \\\\(.*\\\\)\" nil t)\n				(beeminder-add-data \"orgml\" \"1\" (match-string 1))))))\n#+end_src\n\nAnd this loads the beeminder code:\n\n#+BEGIN_SRC emacs-lisp :eval no :tangle no\n(use-package beeminder\n  :config (add-hook 'message-send-news-hook 'sacha/beeminder-track-message))\n#+END_SRC\n\n** Strike through DONE headlines\n\nI wanted a quick way to visually distinguish DONE tasks from tasks I\nstill need to do. This [[http://lists.gnu.org/archive/html/emacs-orgmode/2007-03/msg00179.html][handy snippet from the Emacs Org-mode mailing list]] does the trick by striking through the headlines for DONE tasks.\n\n#+begin_src emacs-lisp :tangle no :eval no\n(setq org-fontify-done-headline t)\n(custom-set-faces\n '(org-done ((t (:foreground \"PaleGreen\"   \n                 :weight normal\n                 :strike-through t))))\n '(org-headline-done \n            ((((class color) (min-colors 16) (background dark)) \n               (:foreground \"LightSalmon\" :strike-through t)))))\n#+end_src\n\n** Rainbow delimiters\n\n#+begin_src emacs-lisp  :eval no :tangle no\n(use-package rainbow-delimiters\n  :init (global-rainbow-delimiters-mode))\n#+end_src\n\n** Drupal\n\n#+begin_src emacs-lisp :eval no :tangle no\n  (define-derived-mode drupal-mode php-mode \"Drupal\"\n    \"Major mode for Drupal source code.\n  \\\\{drupal-mode-map}\"\n    (setq case-fold-search t) \n    (setq indent-tabs-mode nil)\n    (setq c-basic-offset 2)\n    (setq indent-tabs-mode nil)\n    (setq tab-width 2)\n    (setq fill-column 78)\n    (c-set-offset 'arglist-cont 0)\n    (c-set-offset 'arglist-intro '+)\n    (c-set-offset 'case-label 2)\n    (c-set-offset 'arglist-close 0)\n    (setq yas/buffer-local-condition \n    '(cond\n     ((looking-at \"\\\\w\") nil)\n     ((and\n       (not (bobp))\n       (or (equal \"font-lock-comment-face\"\n                  (get-char-property (1- (point)) 'face))\n           (equal \"font-lock-string-face\"\n                  (get-char-property (1- (point)) 'face))))\n      '(require-snippet-condition . force-in-comment))\n     (t t))))\n  (define-key drupal-mode-map (kbd \"TAB\") 'indent-according-to-mode)\n  (add-hook 'drupal-mode-hook (lambda () (flymake-mode 1)))\n  (add-hook 'drupal-mode-hook (lambda () (yas/minor-mode 1)))\n  (add-to-list 'auto-mode-alist '(\"\\\\.\\\\(php\\\\|test\\\\|module\\\\|inc\\\\|install\\\\|engine\\\\|profile\\\\|.theme\\\\)$\" . drupal-mode))\n  (add-to-list 'auto-mode-alist '(\"\\\\.tpl.php$\" . html-helper-mode))\n  (define-key drupal-mode-map '[M-S-up] 'flymake-goto-prev-error)\n  (define-key drupal-mode-map '[M-S-down] 'flymake-goto-next-error)\n  (define-key drupal-mode-map (kbd \"C-c C-c\") 'comment-dwim)\n  \n  (defun sacha/drupal-module-name ()\n    \"Return the Drupal module name for .module and .install files.\"    (file-name-sans-extension (file-name-nondirectory\n                               (buffer-file-name))))\n  (add-to-list 'hs-special-modes-alist '(drupal-mode \"{\" \"}\" \"/[*/]\" nil hs-c-like-adjust-block-beginning))\n  \n#+end_src\n\n\n** Autoconnect to IRC so that I don't forget\n\n#+begin_src emacs-lisp  :eval no :tangle no\n(erc :server \"irc.freenode.net\" :port 6667 :nick \"sachac\")\n#+end_src\n   \n** Org - send things to the bottom of the list\nHandy for collecting items together.\n#+begin_src emacs-lisp :eval no :tangle no\n(defun sacha/org-send-to-bottom-of-list ()\n  \"Send the current line to the bottom of the list.\"\n  (interactive)\n  (beginning-of-line)\n  (let ((kill-whole-line t))\n    (save-excursion\n      (kill-liune 1)\n      (org-end-of-item-list)\n      (yank))))\n#+end_src\n** Previous weekly review\n#+begin_src emacs-lisp\n      (defvar sacha/org-quantified-categories \n        '((\"Business\" \n           (\"Earn\" . \"Business - Earn\") \n           (\"E1\" . \"Business - Earn - Consulting - E1\") \n           (\"Connect\" . \"Business - Connect\") \n           (\"Build\" . \"Business - Build\"))\n          (\"Discretionary\"\n           (\"Social\" . \"Discretionary - Social\")\n           (\"Productive\" . \"Discretionary - Productive\")\n           (\"Writing\" . \"Discretionary - Productive - Writing\")\n           (\"Emacs\" . \"Discretionary - Productive - Emacs\")\n           (\"Play\" . \"Discretionary - Play\"))\n          (\"Personal\" ;(\"Biking\" . \"Personal - Bike\")\n           (\"Routines\" . \"Personal - Routines\"))\n          (\"Sleep\" nil)\n          (\"Unpaid work\" \n           (\"Commuting\" . \"Unpaid work - Subway\")\n           (\"Cook\" . \"Unpaid work - Cook\")\n           (\"Tidy\" . \"Unpaid work - Tidy up\")))\n        \"Categories for time summary.\")\n  \n      (defun sacha/org-summarize-time-use (&optional start end)\n        (require 'quantified)\n        (interactive)\n        (unless start (setq start (format-time-string \"%Y-%m-%d\" (days-to-time (- (time-to-number-of-days base-date) 6)))))\n        (unless end (setq end (format-time-string \"%Y-%m-%d\" (days-to-time (1+ (time-to-number-of-days base-date))))))\n        (let ((time-summary (quantified-summarize-time start end))\n              (categories sacha/org-quantified-categories)\n              result)\n          (setq result\n                (mapconcat\n                 (lambda (a)\n                   (if (assoc (car a) time-summary)\n                       (concat\n                        (format \"- %s: %.1f hours\" (car a) (/ (cdr (assoc (car a) time-summary)) 3600.0))\n                        (if (cdr a)\n                            (let ((detail\n                                   (delq nil\n                                         (mapcar (lambda (b)\n                                                   (if (assoc (cdr b) time-summary)\n                                                       (format \"%s: %.1f\"\n                                                               (car b)\n                                                               (/ (cdr (assoc (cdr b) time-summary)) 3600.0))\n                                                     nil))\n                                                 (cdr a)))))\n                              (if detail\n                                  (concat \" (\" (mapconcat 'identity detail \", \") \")\")\n                                \"\"))\n                          \"\")\n                        (if (string-equal (car a) \"Sleep\")\n                            (format \" - average of %.1f hours per day\" (/ (cdr (assoc (car a) time-summary)) 3600.0 7.0))\n                          \"\")\n                        \"\\n\")))\n           categories \"\"))\n    (if (called-interactively-p)\n        (insert result)\n      result)))\n#+end_src\n\nList upcoming tasks so that I can see if I'm overloaded.\n\n#+begin_src emacs-lisp\n  (defun sacha/org-summarize-upcoming-week ()\n    \"Summarize upcoming tasks as a list.\"\n    (interactive)\n    (org-agenda nil \"w\")\n    (let ((string (buffer-string))\n          business relationships life)\n      (with-temp-buffer\n        (insert string)\n        (goto-char (point-min))\n        (while (re-search-forward sacha/weekly-review-line-regexp nil t)\n          (cond\n           ((string= (match-string 1) \"routines\") nil) ; skip routine tasks\n           ((string= (match-string 1) \"business\")\n            (add-to-list 'business (concat \"  - [ ] \" (match-string 3))))\n           ((string= (match-string 1) \"people\")\n            (add-to-list 'relationships (concat \"  - [ ] \" (match-string 3))))\n           (t (add-to-list 'life (concat \"  - [ ] \" (match-string 3)))))))\n      (setq string\n            (concat\n        \"*Plans for next week*\\n\"\n        \"- Business\\n\"\n        (mapconcat 'identity business \"\\n\")\n        \"\\n- Relationships\\n\"\n        (mapconcat 'identity relationships \"\\n\")\n        \"\\n- Life\\n\"\n        (mapconcat 'identity life \"\\n\")))\n      (if (called-interactively-p)\n          (kill-new string)\n        string)))\n#+end_src\n\nThis uses Org Agenda's log mode to summarize the tasks that I checked\noff. I still need to match it up with the plans for the previous week\nto see which items I'd planned ahead, and which ones were new tasks.\n(Hmm, is it important to track those separately? I might just skip it.)\n\n#+begin_src emacs-lisp\n  (defun sacha/org-summarize-previous-week ()\n    \"Summarize previously-completed tasks as a list.\"\n    (interactive)\n    (save-window-excursion\n      (org-agenda nil \"w\")\n      (org-agenda-later -1)\n      (org-agenda-log-mode 16)\n      (let ((string (buffer-string))\n            business relationships life)\n        (with-temp-buffer\n          (insert string)\n        (goto-char (point-min))\n        (while (re-search-forward sacha/weekly-review-line-regexp nil t)\n          (cond\n           ((string= (match-string 1) \"routines\") nil) ; skip routine tasks\n           ((string= (match-string 1) \"business\")\n            (add-to-list 'business (concat \"  - \" (match-string 2))))\n           ((string= (match-string 1) \"people\")\n            (add-to-list 'relationships (concat \"  - \" (match-string 2))))\n           (t (add-to-list 'life (concat \"  - \" (match-string 2)))))))\n      (setq string\n            (concat\n             \"*Accomplished this week*\\n\\n\"\n             \"- Business\\n\"\n             (mapconcat 'identity business \"\\n\")\n             \"\\n- Relationships\\n\"\n             (mapconcat 'identity relationships \"\\n\")\n             \"\\n- Life\\n\"\n             (mapconcat 'identity life \"\\n\")))\n      (if (called-interactively-p)\n          (kill-new string)\n        string))))\n\n    #+end_src\n\n** Animation for Emacs chats\n\n#+begin_src emacs-lisp\n(defun sacha/animate-emacs-chat ()\n  (interactive)\n  (text-scale-set 6)\n  (erase-buffer)\n  (sit-for 3)\n  (let ((list '(\"Emacs Chat: Sacha Chua\"\n                \"interviewed by Bastien Guerry\"\n                \"\"\n                \"July 24, 2013\"\n                \"sachachua.com/emacs-chat\"))\n        (approx-width 41)\n        (approx-height 16)\n        row)\n    (setq row (/ (- approx-height (length list)) 2))\n    (mapcar\n     (lambda (x)\n       (animate-string x\n                       row\n                       (/ (- approx-width (length x)) 2))\n       (setq row (1+ row)))\n     list)))\n#+end_src\n\n** Idle timer\n\nThis snippet is from John Wiegley -\nhttp://lists.gnu.org/archive/html/emacs-orgmode/2010-03/msg00367.html.\nIt shows the org agenda when Emacs is idle.\n\nThanks to winner-mode, I can get back to my previous buffers with C-c\nleft.\n#+begin_src emacs-lisp :eval no :tangle no\n(defun jump-to-org-agenda ()\n  (interactive)\n  (let ((buf (get-buffer \"*Org Agenda*\"))\n        wind)\n    (if buf\n        (if (setq wind (get-buffer-window buf))\n            (select-window wind)\n          (if (called-interactively-p)\n              (progn\n                (select-window (display-buffer buf t t))\n                (org-fit-window-to-buffer)\n                ;; (org-agenda-redo)\n                )\n            (with-selected-window (display-buffer buf)\n              (org-fit-window-to-buffer)\n              ;; (org-agenda-redo)\n              )))\n      (call-interactively 'org-agenda-list)))\n  ;;(let ((buf (get-buffer \"*Calendar*\")))\n  ;;  (unless (get-buffer-window buf)\n  ;;    (org-agenda-goto-calendar)))\n  )\n\n(run-with-idle-timer 300 t 'jump-to-org-agenda)\n\n#+end_src\n** Old Flickr/Evernote export\n\n#+begin_src emacs-lisp :eval no :tangle no\n       ;; I don't use these as much now that I have the functions above.\n       (defun sacha/evernote-extract-links (filename)\n         \"Extract note names and URLs from an ENEX file.\"\n         (interactive)\n         \n         (goto-char (point-min))\n         (let (list)\n           (while (re-search-forward \"<title>\\\\(.+?\\\\)</title>\\\\(.*?\\n\\\\)*?.*?href=\\\"\\\\(.*?\\\\)\\\"\" nil t)\n             (setq list (cons (cons (match-string-no-properties 1) (match-string-no-properties 3)) list)))\n           (delete-region (point-min) (point-max))\n           (insert (mapconcat (lambda (x) (concat \"- [[\" (cdr x) \"][\" (car x) \"]]\")) list \"\\n\"))))      \n       \n       (defun sacha/flickr-extract-this-week ()\n         \"Extract this week's sketch titles and URLs from the flickr_metadata CSV.\"\n         (interactive)\n         (let ((base-date (apply 'encode-time (org-read-date-analyze \"-fri\" nil '(0 0 0))))\n               start end list)\n           (setq start (format-time-string \"%Y-%m-%d\" (days-to-time (- (time-to-number-of-days base-date) 6))))\n           (setq end (format-time-string \"%Y-%m-%d\" (days-to-time (1+ (time-to-number-of-days base-date)))))\n           (setq list (csv-parse-buffer t))\n           (erase-buffer)\n           (insert\n            (mapconcat (lambda (x) (concat \"- [[\" (car x) \"][\" (cdr x) \"]]\"))\n                       (sort\n                        (delq nil\n                              (mapcar (lambda (x)\n                                        (let ((title (cdr (assoc \"FileName\" x))))\n                                          (if (and (not (string< title start))\n                                                   (string< title end))\n                                              (cons (cdr (assoc \"URL\" x)) title))))\n                                      list))\n                        (lambda (a b) (string<  (cdr a) (cdr b)))\n                        )\n                       \"\\n\"))))\n#+end_src\n** Presentation code for Emacs Conference\n<<emacsconf2013>>\n\n#+begin_src  :eval no :tangle no\n  (defvar sacha/org-show-presentation-file \"~/Dropbox/Emacs Conference/public.org\" \"File containing the presentation.\")\n  (defvar sacha/org-show-slide-tag \"slide\" \"Tag that marks slides.\")\n  (defvar sacha/org-show-slide-tag-regexp (concat \":\" (regexp-quote sacha/org-show-slide-tag) \":\"))\n  (require 'eimp)\n    \n  ;; From org-pres--eimp-fit\n  (defun sacha/org-show-eimp-fit ()\n    \"Function used as a hook, fits the image found to the window.\"\n    (when (eq major-mode 'image-mode)\n      (eimp-fit-image-to-window nil)))\n  (add-hook 'find-file-hook 'sacha/org-show-eimp-fit)\n  \n  (defun sacha/org-show-execute-slide ()\n    \"Process slide at point.\n    If it contains an Emacs Lisp source block, evaluate it.\n    If it contains an image, view it and switch to that buffer.\n    Else, focus on that buffer.\n    Hide all drawers.\"\n    (interactive)\n    (find-file sacha/org-show-presentation-file)\n    (org-narrow-to-subtree)\n    (visual-line-mode)\n    (let ((heading-text (nth 4 (org-heading-components))))\n      (cond\n       ;; view images\n       ((and (goto-char (point-min))\n             (re-search-forward \"\\\\[\\\\[.*\\\\.\\\\(jpg\\\\|gif\\\\|png\\\\)\" nil t))\n        (delete-other-windows)\n        (let ((org-link-frame-setup '((file . find-file))))\n          (org-open-at-point))\n        (delete-other-windows)\n        (goto-char (point-min)))\n       ;; find and execute source code blocks\n       ((and (goto-char (point-min))\n             (re-search-forward \"#\\\\+begin_src\" nil t))\n        (let ((info (org-babel-get-src-block-info)))\n          (unwind-protect\n              (eval (read (concat \"(progn \" (nth 1 info) \")\"))))))\n       (t\n        (switch-to-buffer (current-buffer))\n        (text-scale-set 4)\n        (org-show-subtree)\n        (org-cycle-hide-drawers t)\n        (org-display-inline-images)\n        (delete-other-windows)))\n      (set-frame-name heading-text)))\n  \n  (defun sacha/org-show-next-slide ()\n    \"Show the next slide.\"\n    (interactive)\n    (find-file sacha/org-show-presentation-file)\n    (widen)\n    (goto-char (line-end-position))\n    (when (re-search-forward sacha/org-show-slide-tag-regexp nil t)\n      (sacha/org-show-execute-slide)))\n  \n  (defun sacha/org-show-previous-slide ()\n    \"Show the next slide.\"\n    (interactive)\n    (find-file sacha/org-show-presentation-file)\n    (widen)\n    (goto-char (line-beginning-position))\n    (when (re-search-backward sacha/org-show-slide-tag-regexp nil t)\n      (sacha/org-show-execute-slide)))\n  \n  (global-set-key '[f5] 'sacha/org-show-previous-slide)\n  (global-set-key '[f6] 'sacha/org-show-execute-slide)\n  (global-set-key '[f7] 'sacha/org-show-next-slide)\n#+end_src\n\n** Enable minibuffer completion\n[2013-03-31] Superseded by ido-hacks?\n\nIt can be difficult to remember the full names of Emacs commands, so I\nuse =icomplete-mode= for minibuffer completion. This also makes it\neasier to discover commands.\n\n#+begin_src emacs-lisp :eval no :tangle no\n(icomplete-mode 1)\n#+end_src\n\n** Because I'm trying to use helm instead of ido...\n\n*** Ido-mode: Much better navigationy things\n[2013-03-31]: Let's try using Helm instead.\n\nIdo-mode is awesome. Let's make it awesomer. I usually want to go to\nrecently-opened files first.\n\n#+begin_src emacs-lisp :eval no :tangle no\n(use-package ido\n  :init\n  (progn\n  (ido-mode 1)\n  (setq ido-default-buffer-method 'selected-window)\n  (add-hook 'ido-make-file-list-hook 'ido-sort-mtime)\n  (add-hook 'ido-make-dir-list-hook 'ido-sort-mtime)\n  (defun ido-sort-mtime ()\n    (setq ido-temp-list\n          (sort ido-temp-list \n                (lambda (a b)\n                  (let ((ta (nth 5 (file-attributes (concat ido-current-directory a))))\n                        (tb (nth 5 (file-attributes (concat ido-current-directory b)))))\n                    (if (= (nth 0 ta) (nth 0 tb))\n                        (> (nth 1 ta) (nth 1 tb))\n                      (> (nth 0 ta) (nth 0 tb)))))))\n    (ido-to-end  ;; move . files to end (again)\n     (delq nil (mapcar\n                (lambda (x) (if (string-equal (substring x 0 1) \".\") x))\n                ido-temp-list))))))\n#+end_src\n\n*** Ido and Org\n     \n     When I use =org-refile= to organize my notes, I like seeing the\n     latest entries on top. Ido-related and verify-related snippets\n     are from \"Using ido-mode for org-refile (and archiving via\n     refile)\" in [[http://orgmode.org/worg/org-hacks.html][Org Hacks]].\n     \n     #+begin_src emacs-lisp :eval no :tangle no\n         (setq ido-everywhere t)\n         (setq ido-enable-flex-matching t)\n         (setq ido-max-directory-size 100000)\n         (ido-mode (quote both))\n         (setq org-completion-us-ido t)\n     #+end_src\n\n*** Finding files\n\n    I don't want to think about directory structures, I just want to\n    open files. \n\n    #+begin_src emacs-lisp  :eval no :tangle no\n      (require 'filecache)\n      (require 'ido)\n      (defun file-cache-ido-find-file (file)\n        \"Using ido, interactively open file from file cache'.\n      First select a file, matched using ido-switch-buffer against the contents\n      in `file-cache-alist'. If the file exist in more than one\n      directory, select directory. Lastly the file is opened.\"\n        (interactive (list (file-cache-ido-read \"File: \"\n                                                (mapcar\n                                                 (lambda (x)\n                                                   (car x))\n                                                 file-cache-alist))))\n        (let* ((record (assoc file file-cache-alist)))\n          (find-file\n           (expand-file-name\n            file\n            (if (= (length record) 2)\n                (car (cdr record))\n              (file-cache-ido-read\n               (format \"Find %s in dir: \" file) (cdr record)))))))\n      \n      (defun file-cache-ido-read (prompt choices)\n        (let ((ido-make-buffer-list-hook\n               (lambda ()\n                 (setq ido-temp-list choices))))\n          (ido-read-buffer prompt)))\n      (add-to-list 'file-cache-filter-regexps \"docs/html\")\n      (add-to-list 'file-cache-filter-regexps \"\\\\.svn-base$\")\n      (add-to-list 'file-cache-filter-regexps \"\\\\.dump$\")\n    #+end_src     \n\n    To use this code, I add something like\n    \n    #+begin_src emacs-lisp :tangle no :eval no\n      (sacha/file-cache-setup-tree \"sacha/proj1\" \"C-c d\"\n                                   '(\"/dir1\"\n                                     \"/dir2\"))\n    #+end_src\n    to my config. Then =C-c d= (or whatever keyboard shortcut I use)\n    searches for files within the specified directories.\n    \n** Keywiz - keyboard quizzes\n#+begin_src emacs-lisp :eval no :tangle no\n  (use-package keywiz)\n  (defun sacha/load-keybindings ()\n    \"Since we don't want to have to pass through a keywiz game each time...\"\n    (setq keywiz-cached-commands nil)\n    (do-all-symbols (sym)\n      (when (and (commandp sym)\n                 (not (memq sym '(self-insert-command\n                                  digit-argument undefined))))\n        (let ((keys (apply 'nconc (mapcar\n                                   (lambda (key)\n                                     (when (keywiz-key-press-event-p key)\n                                       (list key)))\n                                   (where-is-internal sym)))))\n          ;;  Politically incorrect, but clearer version of the above:\n          ;;    (let ((keys (delete-if-not 'keywiz-key-press-event-p\n          ;;                               (where-is-internal sym))))\n          (and keys\n               (push (list sym keys) keywiz-cached-commands))))))\n  (sacha/load-keybindings)\n  ;; Might be good to use this in org-agenda...\n  (defun sacha/random-keybinding ()\n    \"Describe a random keybinding.\"\n    (let* ((command (keywiz-random keywiz-cached-commands))\n           (doc (and command (documentation (car command)))))\n      (if command\n          (concat (symbol-name (car command)) \" \"\n                  \"(\" (mapconcat 'key-description (cadr command) \", \") \")\"\n                  (if doc\n                      (concat \": \" (substring doc 0 (string-match \"\\n\" doc)))\n                    \"\"))\n        \"\")))\n#+end_src\n\n** Work-in-progress: monthly review\n\n... and for good measure, let's do some kind of monthly review too.\n\n#+begin_src emacs-lisp :eval no :tangle no\n  (defun sacha/org-prepare-monthly-review ()\n    \"Prepare monthly review template.\"\n    (interactive)\n    (let* ((base-date (org-read-date-analyze \"-1m\" nil '(0 0 0)))\n           (start (encode-time 0 0 0 1 (elt base-date 4) (elt base-date 5)))\n           (end (encode-time 0 0 0 1 (1+ (elt base-date 4)) (elt base-date 5))))\n      (save-window-excursion\n        (kill-new\n         (concat\n          \"*** Monthly review: \" (format-time-string \"%B %Y\" base-date) \"  :monthly:\\n\"\n          \"*Blog posts*\\n\\n\"\n          \"*Time review*\\n\"\n          (sacha/org-summarize-time-use\n           (format-time-string \"%Y-%m-%d\" start)\n           (format-time-string \"%Y-%m-%d\" end)\n           (float-time (time-subtract end start))\n          \"\\n\")))\n      (yank))))\n#+end_src\n\n** MobileOrg for Android\n\n    I've been playing around with MobileOrg so that I can review my\n    agenda and capture notes on my smartphone. My main Org file is too\n    big to open easily there, though.\n    \n#+begin_src emacs-lisp :eval no :tangle no\n  (use-package org-mobile\n    :init\n    (progn\n      (autoload 'org-mobile-pull \"org-mobile\" nil t)\n      (autoload 'org-mobile-push \"org-mobile\" nil t))\n    :config\n    (progn\n      (setq org-mobile-directory \"~/Dropbox/mobile\")\n      (setq org-mobile-inbox-for-pull \"~/personal/mobileorg.org\")\n      (setq default-buffer-file-coding-system 'utf-8)\n      (setq org-mobile-files '(\"/cygdrive/c/sacha/personal/organizer.org\"\n                               \"/cygdrive/c/sacha/personal/business.org\"\n                               \"/cygdrive/c/sacha/personal/books.org\"))\n      (setq org-mobile-agendas '(\"a\"))))\n#+end_src\n** Encryption\n\n#+begin_src emacs-lisp :tangle no :eval no\n     (require 'org-crypt)\n     (org-crypt-use-before-save-magic)\n     (setq org-tags-exclude-from-inheritance (quote (\"crypt\")))\n\n     (setq org-crypt-key nil)\n       ;; GPG key to use for encryption\n       ;; Either the Key ID or set to nil to use symmetric encryption.\n\n       ;;     (setq auto-save-default nil)\n       ;; Auto-saving does not cooperate with org-crypt.el: so you need\n       ;; to turn it off if you plan to use org-crypt.el quite often.\n       ;; Otherwise, you'll get an (annoying) message each time you\n       ;; start Org.\n\n       ;; To turn it off only locally, you can insert this:\n       ;;\n       ;; # -*- buffer-auto-save-file-name: nil; -*-\n\n#+end_src\n\n* Games\n** Typing of Emacs\n    #+begin_src emacs-lisp :eval no :tangle no\n      (use-package typing\n        :init\n        (autoload 'typing-of-emacs \"typing\" nil t)\n        :config\n        (progn\n          (setq toe-starting-length 6)\n          (setq toe-starting-time-per-word 2)\n          (setq toe-max-length 20)))\n#+end_src\n** 2048 in Emacs, and colours too																			:emacs:\n	 :PROPERTIES:\n	 :ID:       o2b:e2b41b2d-463c-4469-91b8-63eb97a13b9d\n	 :POST_DATE: [2014-04-16 Wed 23:23]\n	 :POSTID:   27182\n	 :BLOG:     sacha\n	 :END:\n\nWhile browsing through =M-x list-packages=, I noticed that there was a\nnew MELPA package that implemented the 2048 game in Emacs. I wrote the\nfollowing code to colorize it. Haven't tested the higher numbers yet,\nbut they're easy enough to tweak if the colours disagree with your\ntheme. =)\n\n#+begin_src emacs-lisp\n  (defface 2048-2-face '((t (:foreground \"red\"))) \"Face used for 2\" :group '2048-game)\n  (defface 2048-4-face '((t (:foreground \"orange\"))) \"Face used for 4\" :group '2048-game)\n  (defface 2048-8-face '((t (:foreground \"yellow\"))) \"Face used for 8\" :group '2048-game)\n  (defface 2048-16-face '((t (:foreground \"green\"))) \"Face used for 16\" :group '2048-game)\n  (defface 2048-32-face '((t (:foreground \"lightblue\" :bold t))) \"Face used for 32\" :group '2048-game)\n  (defface 2048-64-face '((t (:foreground \"lavender\" :bold t))) \"Face used for 64\" :group '2048-game)\n  (defface 2048-128-face '((t (:foreground \"SlateBlue\" :bold t))) \"Face used for 128\" :group '2048-game)\n  (defface 2048-256-face '((t (:foreground \"MediumVioletRed\" :bold t))) \"Face used for 256\" :group '2048-game)\n  (defface 2048-512-face '((t (:foreground \"tomato\" :bold t))) \"Face used for 512\" :group '2048-game)\n  (defface 2048-1024-face '((t (:foreground \"SkyBlue1\" :bold t))) \"Face used for 1024\" :group '2048-game)\n  (defface 2048-2048-face '((t (:foreground \"lightgreen\" :bold t))) \"Face used for 2048\" :group '2048-game)\n\n  (defvar 2048-font-lock-keywords\n    '((\"\\\\<2\\\\>\" 0 '2048-2-face)\n      (\"\\\\<4\\\\>\" 0 '2048-4-face)\n      (\"\\\\<8\\\\>\" 0 '2048-8-face)\n      (\"\\\\<16\\\\>\" 0 '2048-16-face)\n      (\"\\\\<32\\\\>\" 0 '2048-32-face)\n      (\"\\\\<64\\\\>\" 0 '2048-64-face)\n      (\"\\\\<128\\\\>\" 0 '2048-128-face)\n      (\"\\\\<256\\\\>\" 0 '2048-256-face)\n      (\"\\\\<512\\\\>\" 0 '2048-512-face)\n      (\"\\\\<1024\\\\>\" 0 '2048-1024-face)\n      (\"\\\\<2048\\\\>\" 0 '2048-2048-face)))\n\n  (defun sacha/2048-fontify ()\n    (font-lock-add-keywords nil 2048-font-lock-keywords))\n\n  (defun sacha/2048-set-font-size ()\n    (text-scale-set 5))\n\n  (use-package 2048-game\n    :config\n    (progn\n     (add-hook '2048-mode-hook 'sacha/2048-fontify)\n     (add-hook '2048-mode-hook 'sacha/2048-set-font-size)))\n#+end_src\n\n\n")))
(setq file-name-history '("~/move.out.da.way/.emacs" "c:/Users/mharp/.emacs.d/elpa/alert-20140506.2032/alert.el" "c:/Users/mharp/move.out.da.way/fromsacha.org" "~/.emacs.d/mharp.org" "f:/dl/mharp.org" "c:/Users/mharp/.emacs.d/init.el" "f:/dl/beginner-2-understand-emacs-lisp.txt" "c:/Users/mharp/.emacs.d/elpa/imenu-anywhere-20131210.1130/imenu-anywhere.el" "f:/dl/mharp.org" "c:/Users/mharp/Desktop/.emacs.d/Sacha.org" "c:/Users/mharp/14marfly.txt" "c:/Users/mharp/org/sync/+Rtoday.org" "c:/Users/mharp/org/test" "c:/Users/mharp/org/testOLcsv.org" "c:/Users/mharp/org/learn.elisp.el" "c:/Users/mharp/Desktop/emacs.d/emacs-init.org" "f:/dl/Bids.txt" "f:/dl/76checklist.org" "f:/dl/letter.Len.org" "f:/dl/680672_training(1).vcs" "f:/dl/680672_training(1).csv" "f:/dl/#680672_training(1).csv#" "c:/Users/mharp/.emacs.d/elpa/w3m-20140213.1557/w3m.el" "c:/Users/mharp/.emacs.mini" "c:/Users/mharp/.emacs-w3m" "c:/Users/mharp/org/xy.commands.org" "c:/Users/mharp/org/FutureMedia.org" "c:/Users/mharp/Feb14" "f:/dl/grey.paper.file.list.txt" "c:/cygwin/home/mharp/.reminders" "c:/cygwin/home/mharp/Scriptin/remindoutput" "c:/Users/mharp/.emacs.d/elpa/ido-vertical-mode-readme.txt" "c:/cygwin/home/mharp/.reminders" "c:/Users/mharp/.emacs.d/elpa/ido-vertical-mode-20131209.938/ido-vertical-mode.el"))

;; Buffer section -- buffers listed in same order as in buffer list:
(desktop-create-buffer 206
  "c:/Users/mharp/org/bookmarks.org"
  "bookmarks.org"
  'org-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  152407
  '(150780 nil)
  nil
  nil
  '((buffer-file-coding-system . iso-latin-1-dos) (truncate-lines)))

(desktop-create-buffer 206
  "c:/Users/mharp/org/sync/refile.org"
  "refile.org"
  'org-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  20
  '(7923 nil)
  nil
  nil
  '((buffer-file-coding-system . undecided-dos) (overwrite-mode) (truncate-lines)))

(desktop-create-buffer 206
  "c:/Users/mharp/org/sync/todo.index.org"
  "todo.index.org"
  'org-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode org-indent-mode)
  700
  '(33392 nil)
  nil
  nil
  '((indent-tabs-mode) (buffer-file-coding-system . utf-8-emacs-dos) (truncate-lines)))

(desktop-create-buffer 206
  "c:/Users/mharp/move.out.da.way/.emacs"
  ".emacs"
  'emacs-lisp-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  5555
  '(4932 nil)
  nil
  nil
  '((buffer-file-coding-system . undecided-unix) (truncate-lines)))

(desktop-create-buffer 206
  "c:/Users/mharp/org/sync/ref.index.org"
  "ref.index.org"
  'org-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  8292
  '(14288 nil)
  nil
  nil
  '((buffer-file-coding-system . utf-8-emacs-dos) (truncate-lines)))

(desktop-create-buffer 206
  "c:/Users/mharp/.emacs.d/mharp.org"
  "mharp.org"
  'org-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  21417
  '(21249 nil)
  nil
  nil
  '((buffer-file-coding-system . utf-8-dos) (truncate-lines)))

(desktop-create-buffer 206
  nil
  "*info*"
  'Info-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  793225
  '(1 nil)
  t
  '("c:/emacs/emacs-24.3/info/emacs" "Imenu" ((history ("c:/emacs/emacs-24.3/info/emacs" "Moving by Defuns" 790474) ("c:/emacs/emacs-24.3/info/emacs" "Left Margin Paren" 788110) ("c:/emacs/emacs-24.3/info/emacs" "Defuns" 786110) ("c:/emacs/emacs-24.3/info/emacs" "Program Indent" 794231) ("c:/emacs/emacs-24.3/info/emacs" "Which Function" 793435) ("c:/emacs/emacs-24.3/info/emacs" "Imenu" 793117) ("c:/emacs/emacs-24.3/info/emacs" "Top" 1222) ("dir" "Top" 813) ("c:/emacs/emacs-24.3/info/info" "Top" 1109) ("c:/emacs/emacs-24.3/info/info" "Search Index" 37074) ("c:/emacs/emacs-24.3/info/info" "Search Index" 37165) ("c:/emacs/emacs-24.3/info/info" "Go to node" 39615) ("c:/emacs/emacs-24.3/info/info" "Search Index" 38900) ("c:/emacs/emacs-24.3/info/info" "Help-Int" 30984) ("c:/emacs/emacs-24.3/info/info" "Getting Started" 3728) ("c:/emacs/emacs-24.3/info/info" "Top" 2631) ("dir" "Top" 5149) ("c:/Users/mharp/.emacs.d/elpa/org-plus-contrib-20131230/org" "Top" 2192) ("c:/Users/mharp/.emacs.d/elpa/org-plus-contrib-20131230/org" "Capture - Refile - Archive" 273299) ("c:/Users/mharp/.emacs.d/elpa/org-plus-contrib-20131230/org" "Attachments" 290716) ("c:/Users/mharp/.emacs.d/elpa/org-plus-contrib-20131230/org" "Capture" 274593) ("c:/Users/mharp/.emacs.d/elpa/org-plus-contrib-20131230/org" "Using capture" 276837) ("c:/Users/mharp/.emacs.d/elpa/org-plus-contrib-20131230/org" "Setting up capture" 274831) ("c:/Users/mharp/.emacs.d/elpa/org-plus-contrib-20131230/org" "Capture" 273753) ("c:/emacs/emacs-24.3/info/remember" "Org" 13830) ("c:/emacs/emacs-24.3/info/remember" "Backends" 12303) ("c:/emacs/emacs-24.3/info/remember" "GNU Free Documentation License" 13961) ("c:/emacs/emacs-24.3/info/remember" "Org" 13688) ("c:/emacs/emacs-24.3/info/remember" "Mailbox" 13266) ("c:/emacs/emacs-24.3/info/remember" "Diary" 12869) ("c:/emacs/emacs-24.3/info/remember" "Text File" 12447) ("c:/emacs/emacs-24.3/info/remember" "Backends" 12046) ("c:/emacs/emacs-24.3/info/remember" "Keystrokes" 11589) ("c:/emacs/emacs-24.3/info/remember" "Backends" 12046) ("c:/emacs/emacs-24.3/info/remember" "Text File" 12447) ("c:/emacs/emacs-24.3/info/remember" "Backends" 12046) ("c:/emacs/emacs-24.3/info/remember" "Keystrokes" 11589) ("c:/emacs/emacs-24.3/info/remember" "Function Reference" 10404) ("c:/emacs/emacs-24.3/info/remember" "Quick Start" 10306) ("c:/emacs/emacs-24.3/info/remember" "Implementation" 7552) ("c:/emacs/emacs-24.3/info/remember" "Installation" 5467) ("c:/emacs/emacs-24.3/info/remember" "Introduction" 4841) ("c:/emacs/emacs-24.3/info/remember" "Preface" 2749) ("c:/emacs/emacs-24.3/info/remember" "Top" 2346) ("dir" "Top" 3940))))
  '((tab-width . 8) (buffer-file-coding-system . utf-8-unix) (case-fold-search . t) (truncate-lines)))

(desktop-create-buffer 206
  "f:/dl/letter.Len.org"
  "letter.Len.org"
  'org-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  16493
  '(16492 nil)
  nil
  nil
  '((buffer-file-coding-system . utf-8-emacs-dos) (truncate-lines)))

(desktop-create-buffer 206
  "c:/cygwin/home/mharp/org/sigfile.org"
  "sigfile.org"
  'org-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  1971
  '(3069 nil)
  nil
  nil
  '((buffer-file-coding-system . utf-8-dos) (truncate-lines)))

(desktop-create-buffer 206
  nil
  "Plans"
  'dired-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  5569
  '(130 nil)
  t
  '("c:/Users/mharp/Plans/")
  '((truncate-lines)))

(desktop-create-buffer 206
  "f:/dl/commute.org"
  "commute.org"
  'org-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  9718
  '(13216 nil)
  nil
  nil
  '((buffer-file-coding-system . utf-8-dos) (truncate-lines)))

(desktop-create-buffer 206
  "c:/cygwin/home/mharp/Scriptin/legdr.txt"
  "legdr.txt"
  'text-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  1
  '(69 nil)
  nil
  nil
  '((buffer-file-coding-system . iso-latin-1-unix) (truncate-lines)))

(desktop-create-buffer 206
  "c:/cygwin/home/mharp/Scriptin/leg"
  "leg"
  'text-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  1
  '(480 nil)
  nil
  nil
  '((buffer-file-coding-system . iso-latin-1-unix) (truncate-lines)))

(desktop-create-buffer 206
  "c:/Users/mharp/131119cygcheck.txt"
  "131119cygcheck.txt"
  'text-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  62076
  '(1 nil)
  nil
  nil
  '((buffer-file-coding-system . undecided-dos) (truncate-lines)))

(desktop-create-buffer 206
  "c:/Users/mharp/.emacs.d/elpa/muse-3.20/muse-book.el"
  "muse-book.el"
  'emacs-lisp-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  1
  '(nil nil)
  nil
  nil
  '((buffer-file-coding-system . undecided-unix) (truncate-lines)))

(desktop-create-buffer 206
  "c:/Users/mharp/scriptin/toggle.touchwcom.ahk"
  "toggle.touchwcom.ahk"
  'xahk-mode
  '(abbrev-mode visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  451
  '(1 nil)
  nil
  nil
  '((buffer-file-coding-system . iso-latin-1-dos) (truncate-lines)))

(desktop-create-buffer 206
  "c:/Users/mharp/scriptin/toggle.touch.ahk"
  "toggle.touch.ahk"
  'xahk-mode
  '(abbrev-mode visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  281
  '(1 nil)
  nil
  nil
  '((buffer-file-coding-system . iso-latin-1-dos) (truncate-lines)))

(desktop-create-buffer 206
  "c:/Users/mharp/Diary"
  "diary"
  'diary-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  1
  '(nil nil)
  nil
  nil
  '((buffer-file-coding-system . undecided-unix) (truncate-lines)))

(desktop-create-buffer 206
  "f:/dl/14janfly.txt"
  "14janfly.txt"
  'text-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  6179
  '(11425 nil)
  nil
  nil
  '((buffer-file-coding-system . iso-latin-1-dos) (truncate-lines)))

(desktop-create-buffer 206
  nil
  "Scriptin"
  'dired-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  4910
  '(nil nil)
  t
  '("c:/cygwin/home/mharp/Scriptin/")
  '((truncate-lines)))

(desktop-create-buffer 206
  "c:/cygwin/home/mharp/org/decsreshpda.org"
  "decsreshpda.org"
  'org-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  1
  '(355 nil)
  nil
  nil
  '((buffer-file-coding-system . undecided-dos) (truncate-lines)))

(desktop-create-buffer 206
  "c:/cygwin/home/mharp/org/odds.sb1314.org"
  "odds.sb1314.org"
  'org-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  218
  '(12906 nil)
  nil
  nil
  '((buffer-file-coding-system . iso-latin-1-dos) (truncate-lines)))

(desktop-create-buffer 206
  "c:/Users/mharp/Dropbox/deft/org-project.org"
  "org-project.org"
  'org-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  249
  '(249 nil)
  nil
  nil
  '((buffer-file-coding-system . undecided-dos) (truncate-lines)))

(desktop-create-buffer 206
  "c:/Users/mharp/org/sync/ref.index.org_archive"
  "ref.index.org_archive"
  'org-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  93
  '(nil nil)
  nil
  nil
  '((buffer-file-coding-system . iso-latin-1-dos) (truncate-lines)))

(desktop-create-buffer 206
  "f:/dl/14febbid.org"
  "14febbid.org"
  'org-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  1
  '(680 nil)
  nil
  nil
  '((buffer-file-coding-system . iso-latin-1-dos) (truncate-lines)))

(desktop-create-buffer 206
  "c:/cygwin/home/mharp/.reminders"
  ".reminders"
  'text-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  754
  '(754 nil)
  nil
  nil
  '((buffer-file-coding-system . undecided-unix) (truncate-lines)))

(desktop-create-buffer 206
  "c:/Users/mharp/org/FutureMedia.org"
  "FutureMedia.org"
  'org-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  12586
  '(12586 nil)
  nil
  nil
  '((buffer-file-coding-system . undecided-unix) (truncate-lines)))

(desktop-create-buffer 206
  "c:/Users/mharp/org/xy.commands.org"
  "xy.commands.org"
  'org-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  18
  '(nil nil)
  nil
  nil
  '((buffer-file-coding-system . undecided-dos) (truncate-lines)))

(desktop-create-buffer 206
  "c:/Users/mharp/.newsrc-dribble"
  ".newsrc-dribble"
  'fundamental-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  1
  '(nil nil)
  nil
  nil
  '((buffer-file-coding-system . raw-text-unix) (truncate-lines)))

(desktop-create-buffer 206
  "f:/dl/76checklist.org"
  "76checklist.org"
  'org-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  58
  '(1816 nil)
  nil
  nil
  '((buffer-file-coding-system . undecided-dos) (truncate-lines)))

(desktop-create-buffer 206
  "c:/Users/mharp/org/sync/+Rtoday.org"
  "+Rtoday.org"
  'org-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  1
  '(nil nil)
  nil
  nil
  '((buffer-file-coding-system . undecided-dos) (truncate-lines)))

(desktop-create-buffer 206
  "c:/Users/mharp/14marfly.txt"
  "14marfly.txt"
  'text-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  1041
  '(1236 nil)
  nil
  nil
  '((buffer-file-coding-system . iso-latin-1-dos) (truncate-lines)))

(desktop-create-buffer 206
  "c:/Users/mharp/.emacs.d/init.el"
  "init.el"
  'emacs-lisp-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  486
  '(1 nil)
  nil
  nil
  '((buffer-file-coding-system . iso-latin-1-dos) (truncate-lines)))

(desktop-create-buffer 206
  "c:/Users/mharp/scriptin/9832.2jul.txt"
  "9832.2jul.txt"
  'text-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  801
  '(3 nil)
  nil
  nil
  '((buffer-file-coding-system . utf-8-dos) (truncate-lines)))

(desktop-create-buffer 206
  "c:/Users/mharp/.emacs.d/elpa/alert-20140506.2032/alert.el"
  "alert.el"
  'emacs-lisp-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  33082
  '(nil nil)
  nil
  nil
  '((buffer-file-coding-system . undecided-unix) (truncate-lines)))

(desktop-create-buffer 206
  "c:/Users/mharp/Plans/2014.07.05.muse"
  "2014.07.05.muse"
  'planner-mode
  '(visual-line-mode global-visual-line-mode override-global-mode helm-mode undo-tree-mode)
  10
  '(nil nil)
  nil
  nil
  '((buffer-file-coding-system . utf-8-dos) (truncate-lines)))

